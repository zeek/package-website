{"description": "Watch SMB transactions for files whose filename matches patterns known to be used by ransomware", "tags": null, "version": "master", "depends": null, "test_cmd": null, "build_cmd": null, "url": "https://github.com/corelight/detect-ransomware-filenames", "summary": null, "script_dir": "scripts", "plugin_dir": null, "readme": "# Detect Ransomware Filenames\n\nThis package/script watches SMB transactions to look for known bad filenames\nthat ransomware is known to use. It rides on top of the Anti-Ransomware File\nSystem Resource Manager Lists maintained [here](https://fsrm.experiant.ca/).\n\n## How to use\n\nA Python script (`download-list.py`) is included to be able to refresh the\nlist periodically. By default, it will download the new file to the `inputs/`\nfolder.\n\n## Installing\n\nThis package is available via `zkg`, however since it has two parts (the script\nand the input file), it's often better to install it manually.\n\n### For Zeek\n\nFor Zeek, place the `scripts/check-for-ransomware-filenames.zeek` script and\n`inputs/fsrm_patterns_for_zeek.tsv` files into a directory together, then edit\nyour `local.zeek` file to add a line like the following:\n\n`@load /path/to/check-for-ransomware-filenames.zeek`\n\n### For Corelight\n\nFor a Corelight appliance, use `zkg` to add this repository to a custom bundle,\nwith any other custom packages that you want to load. Use `corelight-client` to\ninstall this bundle.\n\nThen, use `corelight-client` to load the Input file, like so:\n\n`corelight-client -b <sensor IP> bro input upload --name fsrm_patterns_for_zeek.tsv --file fsrm_patterns_for_zeek.tsv`\n\n## Sample Output\n\nThe script generates notices like the following:\n\n```\n{\n  \"_path\": \"notice\",\n  \"_system_name\": \"bas-cl-swsensor-01\",\n  \"_write_ts\": \"2020-04-27T21:40:10.494579Z\",\n  \"_node\": \"worker-02\",\n  \"ts\": \"2020-04-27T21:40:10.494579Z\",\n  \"uid\": \"CNhUff2G2TzzRoQi45\",\n  \"note\": \"Ransomware::KnownBadFilename\",\n  \"msg\": \"Detected potential ransomware! Known bad file name: test3.hj36MM in use by client 10.0.2.51 on file server 172.16.4.66\",\n  \"src\": \"10.0.2.51\",\n  \"dst\": \"172.16.4.66\",\n  \"peer_descr\": \"worker-02\",\n  \"actions\": [\n    \"Notice::ACTION_LOG\"\n  ],\n  \"suppress_for\": 3600\n}\n```\n\nIf/when you get a notice, investigate, ideally as quickly as possible!\n\n## License\n\nPlease read the license file [here](https://raw.githubusercontent.com/corelight/detect-ransomware-filenames/master/./LICENSE) for information about the license\nfor this software.\n"}