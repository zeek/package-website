{"description": "Adds additional fields to the conn.log for the data obtained via Zeek's GeoLocation feature (https://docs.zeek.org/en/current/frameworks/geoip.html).", "tags": "conn, geolocation, logging", "version": "master", "depends": null, "test_cmd": null, "build_cmd": null, "url": "https://github.com/brimsec/geoip-conn", "summary": null, "script_dir": "zeek", "plugin_dir": null, "readme": "# geoip-conn - Add geolocation fields to `conn` logs\n\n## Summary\n\nIf you have Zeek compiled with\n[GeoLocation support](https://docs.zeek.org/en/current/frameworks/geoip.html),\nthis package will add a nested record called `geo` to the `conn` log that\nconains fields for each originating and responding IP that describe:\n\n* Country code\n* Region\n* City\n* Latitude\n* Longitude\n\nA [GeoLite2](https://dev.maxmind.com/geoip/geoip2/geolite2/) geolocation\ndatabase is included with the package for out-of-the-box functionality.\n\n## Attributions\n\nThis package includes GeoLite2 data created by MaxMind, available from\nhttps://www.maxmind.com.\n\nThis package was inspired by an old Zeek script\n[conn-add-geodata.bro](https://github.com/zeek/bro-scripts/blob/master/conn-add-geodata.bro)\nwhich unfortunately lacks author or license information. Before creating this\npackage, a [thread on public Zeek Slack](https://zeekorg.slack.com/archives/CSZBXF6TH/p1594235715230000)\nwas initiated in an attempt to hunt down the author, but no definitive answer\nwas found. This package goes further by being delivered as a\n[Zeek package](https://github.com/zeek/packages) and by adding fields for\nmore than just country info.\n\n## About the included GeoLite2 database\n\nPer the [MaxMind FAQ](https://support.maxmind.com/geolite-faq/), the free\nGeoLite2 database is less accurate than the paid [GeoIP2](https://www.maxmind.com/en/geoip2-databases)\nversion. While the author of this package has not attempted it, the FAQ\nindicates that the paid version should work as a \"drop-in replacement\".\n\nThe MaxMind FAQ also indicates the database is updated weekly, every Tuesday.\nAll attempts will be made to keep the database verison in this repo current.\nHowever, if you're concerned about accuracy, you may want to create your own\nMaxMind login and keep your local copy up to date.\n\nIf you delete the database file `GeoLite2-City.mmdb` that comes with this\npackage, Zeek will fall back to looking for a database in\n[default locations](https://github.com/zeek/zeek/blob/09483619ef0839cad189f22c4d5be3d66cedcf55/src/zeek.bif#L3964-L3971).\n"}