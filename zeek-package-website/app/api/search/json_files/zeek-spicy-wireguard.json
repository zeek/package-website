{"description": "A Wireguard VPN protocol analyzer, based on Spicy.", "tags": null, "version": "v0.1.3", "depends": null, "test_cmd": "cd tests && PATH=$(zkg config plugin_dir)/packages/spicy-plugin/bin:$PATH btest -d -j $(nproc)", "build_cmd": "mkdir -p build && cd build && SPICYZ=$(command -v spicyz || echo %(package_base)s/spicy-plugin/build/bin/spicyz) cmake .. && cmake --build .", "url": "https://github.com/corelight/zeek-spicy-wireguard", "summary": "A Wireguard VPN protocol analyzer, based on Spicy.", "script_dir": "analyzer", "plugin_dir": "build/spicy-modules", "readme": "# zeek-spicy-wireguard\n\nThis package provides a Spicy based Wireguard protocol analyzer\nfor Zeek.\n\nYou must install [Spicy](https://docs.zeek.org/projects/spicy/en/latest/)\nto use this package.\n\nThis is a straightforward implementation following <https://www.wireguard.com/protocol/>\n\n## Wireguard\n\n### Wireguard Logs\n\n```\n#separator \\x09\n#set_separator\t,\n#empty_field\t(empty)\n#unset_field\t-\n#path\tconn\n#open\t2021-11-24-18-10-11\n#fields\tts\tuid\tid.orig_h\tid.orig_p\tid.resp_h\tid.resp_p\tproto\tservice\tduration\torig_bytes\tresp_bytes\tconn_state\tlocal_orig\tlocal_resp\tmissed_bytes\thistory\torig_pkts\torig_ip_bytes\tresp_pkts\tresp_ip_bytes\ttunnel_parents\n#types\ttime\tstring\taddr\tport\taddr\tport\tenum\tstring\tinterval\tcount\tcount\tstring\tbool\tbool\tcount\tstring\tcount\tcount\tcount\tcount\tset[string]\n1611583877.627931\tCHhAvVGS1DHFjwGM9\t188.166.170.114\t45965\t188.166.170.115\t51194\tudp\tspicy_wireguard\t35.595192\t13516\t14924\tSF\t-\t-\t0\tDd\t90\t16036\t82\t17220\t-\n#close\t2021-11-24-18-10-11\n```\n\n```\n#separator \\x09\n#set_separator\t,\n#empty_field\t(empty)\n#unset_field\t-\n#path\twireguard\n#open\t2021-11-24-18-10-11\n#fields\tts\tuid\tid.orig_h\tid.orig_p\tid.resp_h\tid.resp_p\testablished\tinitiations\tresponses\n#types\ttime\tstring\taddr\tport\taddr\tport\tbool\tcount\tcount\n1611583877.627931\tCHhAvVGS1DHFjwGM9\t188.166.170.114\t45965\t188.166.170.115\t51194\tT\t1\t1\n#close\t2021-11-24-18-10-11\n```\n\n### Wireguard PCAP Source\n\n- wireguard.pcap (self-made)\n\nThis package also detects...\n\n## Tailscale\n\n[Tailscale](https://tailscale.com/) is a VPN that modifies the Wireguard protocol\nslightly by adding Tailscale discovery messages.  While the generic Wireguard protocol\nanalyzer in this repo will not support this, this protocol analyzer will.\n\nRelevant code section: <https://github.com/tailscale/tailscale/blob/main/disco/disco.go#L32>\n\n### Tailscale Logs\n\n```\n#separator \\x09\n#set_separator\t,\n#empty_field\t(empty)\n#unset_field\t-\n#path\tconn\n#open\t2021-11-24-18-11-40\n#fields\tts\tuid\tid.orig_h\tid.orig_p\tid.resp_h\tid.resp_p\tproto\tservice\tduration\torig_bytes\tresp_bytes\tconn_state\tlocal_orig\tlocal_resp\tmissed_bytes\thistory\torig_pkts\torig_ip_bytes\tresp_pkts\tresp_ip_bytes\ttunnel_parents\n#types\ttime\tstring\taddr\tport\taddr\tport\tenum\tstring\tinterval\tcount\tcount\tstring\tbool\tbool\tcount\tstring\tcount\tcount\tcount\tcount\tset[string]\n1623328901.893092\tCHhAvVGS1DHFjwGM9\t192.168.88.3\t41641\t18.196.71.179\t41641\tudp\tspicy_tailscale\t31.882638\t5700\t6322\tSF\t-\t-\t0\tDd\t51\t7128\t56\t7890\t-\n#close\t2021-11-24-18-11-40\n```\n\n### Tailscale PCAP Source\n\n- tailscale_linux.pcap (self-made)\n"}