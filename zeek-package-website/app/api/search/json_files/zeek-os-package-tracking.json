{"description": null, "tags": null, "version": "main", "depends": null, "test_cmd": null, "build_cmd": null, "url": "https://github.com/0xxon/zeek-os-package-tracking", "summary": null, "script_dir": null, "plugin_dir": null, "readme": "# Zeek OS & package info detector\n\nThe goal of this script is to detect certain operating systems, mostly Linux and BSD-based, and the packages installed on said operating systems.\n\nInformation about the found operating systems as well as the packages that have been found are written to new log-files.\n\nThe information collected by this script is extracted from HTTP requests. This is possible since Linux/BSD systems download packages via unencrypted HTTP (the packages are signed and cannot be modified by an attacker in transit).\n\nCurrent supported operating systems are:\n\n* Debian\n* Ubuntu\n* FreeBSD\n* CentOS based systems\n\nPlanned additions:\n\n* Fedora\n* OpenSUSE\n\nPlease note that this script has not seen significant amounts of testing; it is likely that it will miss hosts and possible that it will generate incorrect findings. Future versions of this script might change the log-file-format.\n\n### Logs\n\nThis script generates two new logs, `os_info.log` and `package_info.log`. The former log-file contains information about operating systems, the second about packages.\n\nInformation in `os_info.log` is cached for one day on each worker node, by default (setting: `OSPTracking::os_tracking_interval`).\n\nExample `os_info.log`:\n\n```\n#fields\tts\thost\tos\tversion\tplatform\trequest.user_agent\trequest.host\trequest.uri\n#types\ttime\taddr\tstring\tstring\tstring\tstring\tstring\tstring\n1621264582.343810\t207.154.248.206\tFreeBSD\t12.2-RELEASE-p1\t-\tfreebsd-update (fetch, 12.2-RELEASE-p1)\tupdate1.freebsd.org\t/12.2-RELEASE/amd64/latest.ssl\n1621263628.479609\t2a03:b0c0:3:d0::13b7:9001\tUbuntu\thirsute\t-\tDebian APT-HTTP/1.3 (2.2.3) non-interactive\tmirrors.digitalocean.com\t/ubuntu/dists/hirsute-updates/InRelease\n1621263629.074601\t2a03:b0c0:3:d0::13b7:9001\tUbuntu\thirsute\tamd64\tDebian APT-HTTP/1.3 (2.2.3) non-interactive\tsecurity.ubuntu.com\t/ubuntu/dists/hirsute-security/main/binary-amd64/by-hash/SHA256/1871aa091cb7002e9fa33443ff3097222648f1cbb9fd8426943b28bcb4e5eef5\n```\n\nExample `package_info.log`:\n\n```\n#fields\tts\thost\tos\tos_version\tplatform\tpackage\tversion\tprev_version\trequest.user_agent\trequest.host\trequest.uri\n#types\ttime\taddr\tstring\tstring\tstring\tstring\tstring\tstring\tstring\tstring\tstring\n1621264718.280198\t207.154.248.206\tFreeBSD\t12\tamd64\tpkg\t1.16.3\t-\tpkg/1.16.1\tpkgmir.geo.freebsd.org\t/FreeBSD:12:amd64/quarterly/All/pkg-1.16.3.txz\n1621264721.407269\t207.154.248.206\tFreeBSD\t12\tamd64\tgit\t2.31.1_1\t-\tpkg/1.16.3\tpkgmir.geo.freebsd.org\t/FreeBSD:12:amd64/quarterly/All/git-2.31.1_1.txz\n1621264721.910978\t207.154.248.206\tFreeBSD\t12\tamd64\tp5-CGI\t4.51\t-\tpkg/1.16.3\tpkgmir.geo.freebsd.org\t/FreeBSD:12:amd64/quarterly/All/p5-CGI-4.51.txz\n1621264721.943651\t207.154.248.206\tFreeBSD\t12\tamd64\tp5-HTML-Parser\t3.75\t-\tpkg/1.16.3\tpkgmir.geo.freebsd.org\t/FreeBSD:12:amd64/quarterly/All/p5-HTML-Parser-3.75.txz\n1621263639.242450\t2a03:b0c0:3:d0::13b7:9001\tUbuntu\t-\tamd64\tlinux-modules-5.11.0-17-generic\t5.11.0-17.18\t-\tDebian APT-HTTP/1.3 (2.2.3) non-interactive\tmirrors.digitalocean.com/ubuntu/pool/main/l/linux/linux-modules-5.11.0-17-generic_5.11.0-17.18_amd64.deb\n1621263639.307801\t2a03:b0c0:3:d0::13b7:9001\tUbuntu\t-\tamd64\tlinux-image-5.11.0-17-generic\t5.11.0-17.18\t-\tDebian APT-HTTP/1.3 (2.2.3) non-interactive\tmirrors.digitalocean.com/ubuntu/pool/main/l/linux-signed/linux-image-5.11.0-17-generic_5.11.0-17.18_amd64.deb\n1621263639.434855\t2a03:b0c0:3:d0::13b7:9001\tUbuntu\t-\tamd64\tlinux-virtual\t5.11.0.17.18\t-\tDebian APT-HTTP/1.3 (2.2.3) non-interactive\tmirrors.digitalocean.com\t/ubuntu/pool/main/l/linux-meta/linux-virtual_5.11.0.17.18_amd64.deb\n1621263639.493213\t2a03:b0c0:3:d0::13b7:9001\tUbuntu\t-\tamd64\tlinux-image-virtual\t5.11.0.17.18\t-\tDebian APT-HTTP/1.3 (2.2.3) non-interactive\tmirrors.digitalocean.com\t/ubuntu/pool/main/l/linux-meta/linux-image-virtual_5.11.0.17.18_amd64.deb\n1621263639.648662\t2a03:b0c0:3:d0::13b7:9001\tUbuntu\t-\tamd64\tlinux-headers-virtual\t5.11.0.17.18\t-\tDebian APT-HTTP/1.3 (2.2.3) non-interactive\tmirrors.digitalocean.com\t/ubuntu/pool/main/l/linux-meta/linux-headers-virtual_5.11.0.17.18_amd64.deb\n```\n\n### Installation\n\nUsing zkg:\n\n```\nzkg install 0xxon/zeek-os-package-tracking\n```\n\nManually:\n\nCopy `os-package-tracking.zeek` into your `site` directory and `@load` it from `local.zeek`.\n\n### Configuration\n\nConfigure the hosts that are tracked by changing the `OSPTracking::track_hosts` option. By default all hosts are tracked.\n\n## Acknowledgements\n\nThis work was supported by the US National Science Foundation under grant [OAC-1642161](https://nsf.gov/awardsearch/showAward?AWD_ID=1642161&HistoricalAwards=false).\nAny opinions, findings, and conclusions or recommendations\nexpressed in this material are those of the authors or origina-\ntors, and do not necessarily reflect the views of the National\nScience Foundation.\n\n"}