{"description": null, "tags": "conn, mac", "version": "master", "depends": null, "test_cmd": null, "build_cmd": null, "url": "https://github.com/tenzir/zeek-mac-ages", "summary": null, "script_dir": "scripts/tenzir/mac-ages", "plugin_dir": null, "readme": "Zeek & MAC Address Ages\n=======================\n\nThis [Zeek](https://zeek.org) plugin adds functionality to query the age of a\nMAC address. The data comes from HD Moore's [MAC Adress Age\nTracking](https://github.com/hdm/mac-ages) repository, which is a curated\ndatabase of MAC addresses bootstrapped from the\n[DeepMAC](https://raw.githubusercontent.com/tenzir/zeek-mac-ages/master/http://www.deepmac.org) and [Wireshark](https://raw.githubusercontent.com/tenzir/zeek-mac-ages/master/http://www.wireshark.org)\narchives. A bot pulls from an IEEE website daily to keep the data up to date.\n\nUsage\n-----\n\nFirst, install the package with the [Zeek package\nmanager](https://github.com/zeek/package-manager):\n\n```sh\nzkg install tenzir/zeek-mac-ages\n```\n\nThen make sure that you have a recent version of the MAC database installed\nsomewhere. Set the environment variable `ZEEK_TENZIR_MAC_AGES_CSV` to the CSV\nfile and you're set to load the plugin:\n\n```zeek\n@load tenzir/mac-ages\n```\n\nBy default, the script enhances the stock DHCP log with a field `mac_age`\ncontaining the approximate \"birthday\" of a MAC address in YYYY-MM-DD format.\nHere's an example log file generated with a [sample trace from the Wireshark\nwiki](https://wiki.wireshark.org/SampleCaptures):\n\n```\n#separator \\x09\n#set_separator\t,\n#empty_field\t(empty)\n#unset_field\t-\n#path\tdhcp\n#open\t2018-12-28-15-47-11\n#fields\tts\tuids\tclient_addr\tserver_addr\tmac\thost_name\tclient_fqdn\tdomain\trequested_addr\tassigned_addr\tlease_time\tclient_message\tserver_message\tmsg_types\tduration\tmac_age\n#types\ttime\tset[string]\taddr\taddr\tstring\tstring\tstring\tstring\taddr\taddr\tinterval\tstring\tstring\tvector[string]\tinterval\tstring\n1102274184.387484\tCMnxGv1YFAUvoaADr2,CzdoL23dzCo4Zuq0d8\t192.168.0.10\t192.168.0.1\t00:0b:82:01:fc:42\t-\t-\t-\t192.168.0.10\t192.168.0.10\t3600.000000\t-\t-\tREQUEST,ACK\t0.000314\t2002-10-14\n1102274184.317453\tCMnxGv1YFAUvoaADr2,CzdoL23dzCo4Zuq0d8\t192.168.0.10\t192.168.0.1\t00:0b:82:01:fc:42\t-\t-\t-\t0.0.0.0\t192.168.0.10\t3600.000000\t-\t-\tDISCOVER,OFFER\t0.000295\t2002-10-14\n#close\t2018-12-28-15-47-11\n```\n\nFor more fine-grained control, have a lok at the [new builtin\nfunctions](https://raw.githubusercontent.com/tenzir/zeek-mac-ages/master/src/mac_ages.bif) (BiFs) for replacing the MAC age database\naddresses and performing lookups a MAC addresses.\n\nDevelopment\n-----------\n\nIf you want to compile the plugin from scratch, use the accompanying\n[`configure`](https://raw.githubusercontent.com/tenzir/zeek-mac-ages/master/configure) helper script:\n\n```sh\nexport ZEEK=/path/to/zeek-dist\n./configure --zeek-dist=\"$ZEEK\"\ncd build\nmake\n```\n\nAfter the compilation succeeded, notify Zeek about the plugin:\n\n```sh\nexport ZEEK_PLUGIN_PATH=$(pwd)\nexport ZEEKPATH=\"$($ZEEK/build/zeek-path-dev):$ZEEK_PLUGIN_PATH/..\"\nalias zeek=$ZEEK/build/src/zeek\nzeek -N | grep tenzir\n```\n\nThis should print:\n\n\n```\ntenzir::mac_ages - MAC address age estimation (dynamic, version 0.1.0)\n```\n\nYou can now play with code. For example, to generate the above log file:\n\n```\nwget https://github.com/hdm/mac-ages/raw/master/data/mac-ages.csv\nexport ZEEK_TENZIR_MAC_AGES_CSV=mac-ages.csv\nzeek -C -r $ZEEK/testing/btest/Traces/dhcp/dhcp.trace tenzir/mac-ages\n```\n\nThis should generate a `dhcp.log` `2012-07-11` in the column `mac_age` for the\nMAC address `90:b1:1c:99:49:29`.\n\nLICENSE\n-------\n\nThis plugin comes with a BSD license.\n"}