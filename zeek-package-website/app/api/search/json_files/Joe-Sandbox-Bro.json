{"description": "JoeSandbox-Bro extracts files from your internet connection", "tags": "file analysis, sandbox, malware, virus", "version": "master", "depends": null, "test_cmd": null, "build_cmd": null, "url": "https://github.com/joesecurity/Joe-Sandbox-Bro", "summary": null, "script_dir": "scripts", "plugin_dir": null, "readme": "# JoeSandbox-Bro\n\nJoeSandbox-[Bro](https://www.bro.org) is a simple bro script which extracts files from your internet connection and analyzes them automatically on [Joe Sandbox](https://www.joesecurity.org/).\nBy using this script you can fetch and detect malware payloads in HTTP, FTP and other protocols. Combined with Joe Sandbox's report and alerting features you can build with JoeSandbox-Bro a powerful IDS.\n\n![Bro extracts files between the internet and your hosts and uploads them to Joe Sandbox.](https://raw.githubusercontent.com/joesecurity/Joe-Sandbox-Bro/master/img/flow.png)\n\n# Requirements\n\n* Python 2.7 or 3.5+\n* The `jbxapi` library: `pip install jbxapi`\n* Bro 2.5\n* The [Bro package manager](https://raw.githubusercontent.com/joesecurity/Joe-Sandbox-Bro/master/http://bro-package-manager.readthedocs.io): `pip install bro-pkg`\n\n# Installation (for people familiar with Bro)\n\n1. Installation\n\n        pip install jbxapi\n        bro-pkg refresh\n        bro-pkg install joesecurity/Joe-Sandbox-Bro\n\n2. Configuration\n\n    The most important settings are your api key and accepting the terms and conditions:\n\n        # api key\n        redef JoeSandbox::apikey = \"YOUR API KEY\";\n\n        # https://jbxcloud.joesecurity.org/download/termsandconditions.pdf\n        redef JoeSandbox::accept_tac = T;\n\n        # for on-premise installations\n        # redef JoeSandbox::apiurl = \"https://example.net/joesandbox/index.php/api/\";\n\n# Step-by-step for inexperienced users (not recommended for production environments)\n\n1. Install Linux. (We used Ubuntu 16.04.)\n2. Install Bro 2.5:\n\n    [https://www.bro.org/download/packages.html](https://www.bro.org/download/packages.html)\n\n3. You need to be root for the rest of this example:\n\n        sudo -s\n\n4. Install some software:\n\n        pip install bro-pkg\n        pip install jbxapi\n\n5. Add Bro to your path:\n\n        export PATH=\"$PATH:/opt/bro/bin\"\n\n6. Configure `bro-pkg` and download `Joe-Sandbox-Bro`:\n\n        bro-pkg autoconfig\n        bro-pkg install joesecurity/Joe-Sandbox-Bro\n\n7. Write a small script and save it as `example.bro`:\n\n        @load Joe-Sandbox-Bro\n\n        redef JoeSandbox::apikey = \"YOUR_API_KEY\";\n        # https://jbxcloud.joesecurity.org/download/termsandconditions.pdf\n        redef JoeSandbox::accept_tac = T;\n\n        # optionally submit sample.txt on startup\n        # event bro_init()\n        #     {\n        #         when (local webids = JoeSandbox::submit(\"sample.txt\")) {\n        #             print webids;\n        #         }\n        #     }\n\n8. Run Bro:\n\n        bro -C -i eth0 example.bro\n\nBro now extracts all PE files it sees and uploads them to Joe Sandbox.\n\n# Alerts for malicious files\n\nIf the script is working properly, you should now setup an alert to get notified if Joe Sandbox detect a file as malicious.\nFor this, open the alerts page in the web interface of Joe Sandbox and add a new alert. Set the `XPath` field to\n\n    /analysis/signaturedetections/strategy[@name='empiric']/detection[text()='MAL']\n\nThen add e-mail addresses and finally save the alert. You will now receive alerts for all malicious analysis.\n\n# Example\n\nDuring analysis in a network we were able to detect second stage downloads by [Kovter](https://raw.githubusercontent.com/joesecurity/Joe-Sandbox-Bro/master/www.joesecurity.org/reports/report-710857729c9adb7e41d9aac8ed842329.html):\n\n![detected kovter samples](https://raw.githubusercontent.com/joesecurity/Joe-Sandbox-Bro/master/img/overview.png)\n\n![e-mail alert for kovter](https://raw.githubusercontent.com/joesecurity/Joe-Sandbox-Bro/master/img/alert.png)\n\n![kovter http](https://raw.githubusercontent.com/joesecurity/Joe-Sandbox-Bro/master/img/kovter.png)\n\n# License\n\nThe code is licensed under MIT.\n\n# Links\n\n* [Bro](https://www.bro.org)\n* [Joe Sandbox Cloud](https://www.joesecurity.org/joe-sandbox-cloud)\n\n# Author\n\nJoe Security ([@joe4security](https://twitter.com/joe4security) - [webpage](https://www.joesecurity.org))\n"}