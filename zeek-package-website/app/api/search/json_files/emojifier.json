{"description": "Set your logs on fire with Emojifier!", "tags": "emoji, fire, emojifier", "version": "master", "depends": null, "test_cmd": "cd testing && btest -d", "build_cmd": null, "url": "https://github.com/emojifier/emojifier", "summary": null, "script_dir": "scripts", "plugin_dir": null, "readme": "<img src=\"docs/emojifier_logo.png\" width=\"240\" height=\"240\" />\n\n# Set your logs on fire with Emoji-\ud83d\udd25\n\nEmojifier is the \ud83d\udd28 of choice to get a fast overview on your [Zeek](https://www.zeek.org/) connection log.\nOn top, it also serves as the perfect management summary of your network's security status. \ud83d\udc79\ud83d\udee1\ufe0f\ud83c\udfe2\n\nIt adds an additional column to your conn.log showing emojis that give you information about the connections in your log.\nThe following emojis are currently supported:\n\n| Emoji | Meaning                                |\n| ----- | -------------------------------------- |\n| \ud83c\udfc4    | HTTP Traffic                           |\n| \ud83d\udd0d    | DNS Traffic                            |\n| \ud83d\udce8    | SMTP Traffic                           |\n| \u260e\ufe0f    | SIP Traffic                            |\n| \ud83e\udd75    | Connection with many bytes             |\n| \ud83d\ude48    | Some bytes were missed                 |\n| \ud83d\ude1b    | TCP Connection was rejected            |\n| \ud83d\udd04    | Connection direction was flipped       |\n| \ud83d\udea8    | There is a notice for this connection  |\n| \ud83e\udd74    | Zeek deems this connection weird       |\n| \ud83d\udd25    | There was an Intel hit                 |\n\nFurthermore, there is an additional script to emojify default policies.\nAdd `@load emojifier/emojify-policies` to your `local.zeek` to enable the following additional emojis:\n\n| Emoji | Meaning                                |\n| ----- | -------------------------------------- |\n| \u231b    | Expired certificate                    |\n| \u23f3    | Certificate expires soon               |\n| \ud83d\ude15    | Old TLS version                        |\n| \ud83d\udc93    | Heartbleed attack detected             |\n| \ud83d\udc89    | SQL injection detected                 |\n| \ud83d\udca3    | Vulnerable software version            |\n| \ud83e\udd14    | Login with guessed SSH password        |\n\n### Usage \ud83d\ude0e\n\nThe scripts are available as package for the [Zeek Package Manager](https://github.com/zeek/package-manager) and can be installed using the following command: `zkg install emojifier`\nTo set your logs on \ud83d\udd25 make sure the package is loaded: `zkg load emojifier`\nTo enable the additional emojis including the corresponding policy scripts add `@load emojifier/emojify-policies` to your `local.zeek`.\nPlease note that emojification (utf8 support) is a Zeek-only feature. If you haven't already upgraded to Zeek, \ud83d\udc46 is the reason you should do it!\n\n### Fun with Flags \ud83c\udde9\ud83c\uddea \ud83c\uddfa\ud83c\uddf8 \ud83c\uddef\ud83c\uddf2\n\nOf course, we have also added support for Zeek's GeoLocation framework. First you need to make sure that the framework is available (see [Zeek Docs](https://docs.zeek.org/en/current/frameworks/geoip.html)). For a quick test run a command like the following:\n```\nzeek -e \"print lookup_location(8.8.8.8);\"\n```\nIf that works without any issues, you are ready to go. Just add `@load emojifier/emojify-geo` to your `local.zeek`.\n\n### Extending \ud83e\uddd0\n\nWant to put \ud83d\udd25? No problem, the emojifier can be easily extended. Just add your custom logic by handling an event and concatenating the additional emoji to the `emoji_trail` string in the `connection` record. The following example adds the \ud83d\udd73 emoji.\n```zeek\nevent connection_state_remove(c: connection) &priority=5\n\t{\n\tif ( c?$tunnel )\n\t\tc$emoji_trail += \"\ud83d\udd73\";\n\t}\n```\nNote that you need to use a priority > 0 in case you are handling the `connection_state_remove` event.\n\nIf you want to extend the Emoji-\ud83d\udd25 based on notices that is even easier. You just need to extend the `Emojifier::custom_notices` table:\n```zeek\nredef custom_notices += {\n\t[Notice::Tally] = \"\ud83e\udd2d\",\n};\n```\nWe are looking forward to merge your pull-request \ud83d\ude09\n"}