{"description": "Detect CVE-2022-22954 attempts and exploits.", "tags": null, "version": "v0.1.0", "depends": null, "test_cmd": "cd testing && btest -c btest.cfg", "build_cmd": null, "url": "https://github.com/corelight/cve-2022-22954", "summary": "Detect CVE-2022-22954 attempts and exploits.", "script_dir": "scripts", "plugin_dir": null, "readme": "# CVE-2022-22954\n\nThis package detects a subset of\n[CVE-2022-22954](https://nvd.nist.gov/vuln/detail/CVE-2022-22954) attempts and\nexploits, generates a notice, and also includes the exploit URI and the first\n4KB of the data that was sent back to the attacker as a response. While\ndetecting this attack is more straightforward from [log\nanalysis](https://corelight.com/blog/finding-cve-2022-22954-with-zeek), this\npackage helps by logging the response sent back to the attacker to aid in\nincidence response.\n\n## Sample Notice\n\nTwo notices can be generated from this package:\n\n* `VMWareRCE2022::ExploitAttempt`, and\n* `VMWareRCE2022::ExploitSuccess`\n\nThe first is generated when an attack is attempted, but does not necessarily\nsucceed. The second is fired only when a successful exploit is detected and\nshould be investigated immediately. Below is an example of a successful exploit\nnotice.\n\n```\n1223906136.104000       C5uvDn3o7ejGdRxeVb      -       -       -       -       -       -       -       -       VMWareRCE2022::ExploitSuccess   192.168.0.1 successfully exploited 173.37.145.84. See sub for uri/response.     uri: /catalog-portal/ui/oauth/verify?error=&deviceUdid=${{freemarker.template.utility.Execute?new()(whoami)}}; response: www-data\\x0a        -       -       -       -       -       Notice::ACTION_LOG      (empty) 3600.000000     -       -       -       -       -\n```\n\n## Installing\n\nThis package can be installed with `zkg` using the following commands:\n\n```\n$ zkg refresh\n$ zkg install cve-2022-22954\n```\n\nCorelight customers can install it by updating the CVE bundle.\n"}