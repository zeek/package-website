{"description": "Extract files from network traffic with Zeek.", "tags": "files, file extraction, file analysis", "version": "2.0.3", "depends": null, "test_cmd": null, "build_cmd": null, "url": "https://github.com/hosom/file-extraction", "summary": null, "script_dir": "scripts", "plugin_dir": null, "readme": "#  Module for File Extraction\n\nThis is a Zeek package that provides convenient extraction of files.\n\nAs a secondary goal, this script performs additional commonly requested file extraction and logging tasks, such as naming extracted files after their calculated file checksum or naming the file with its common file extension.\n\n## Installing with zkg (preferred)\n\nThis package can be installed through the [zeek package manager](https://docs.zeek.org/projects/package-manager/en/stable/quickstart.html) by utilizing the following commands:\n\n```sh\nzkg install zeek/hosom/file-extraction\n\n# you must separately load the package for it to actually do anything\nzkg load zeek/hosom/file-extraction\n```\n\n## Installing manually\n\nWhile not preferred, this package can also be installed manually. To do this, follow the tasks below:\n\n```\ncd <prefix>/share/zeek/site\n\ngit clone git://github.com/hosom/file-extraction file-extraction\n\necho \"@load file-extraction\" >> local.zeek\n```\n\n## Configuration\n\nThe package installs with the **extract-common-exploit-types.zeek** policy, however, additional functionality may be desired. \n\nConfiguration must **always be done within the config.zeek** file. Failure to isolate configuration to **config.zeek** will result in your configuration being overwritten.\n\n### Advanced Configuration\n\nFor advanced configuration of file extraction, the best option available is to hook the FileExtraction::extract hook. For examples of this, look at the scripts in the plugins directory.\n\n## Plugins\n\n### extract-all-files.zeek\n\nAttaches the extract files analyzer to every file that has a mime_type detected.\n\n### extract-java.zeek\n\nAttaches the extract files analyzer to every JNLP and Java Archive file detected.\n\n### extract-pe.zeek\n\nAttaches the extract files analyzer to every PE file detected.\n\n### extract-ms-office.zeek\n\nAttaches the extract files analyzer to every ms office file detected.\n\n### extract-pdf.zeek\n\nAttaches the extract files analyzer to every PDF file detected.\n\n### extract-common-exploit-types.zeek\n\nLoads the following plugins:\n- extract-java.zeek\n- extract-pe.zeek\n- extract-ms-office.zeek\n- extract-pdf.zeek\n\n### store-files-by-md5.zeek\n\nUses file_state_remove to rename extracted files based on the md5 checksum whenever it is available.\n\n### store-files-by-sha1.zeek\n\nUses file_state_remove to rename extracted files based on the sha1 checksum whenever it is available.\n\n### store-files-by-sha256.zeek\n\nUses file_state_remove to rename extracted files based on the sha256 checksum whenever it is available.\n"}