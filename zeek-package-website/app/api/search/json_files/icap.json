{"description": "Internet Content Adaptation Protocol (ICAP) Analyzer for Bro and Zeek.", "tags": "bro plugin, zeek plugin, protocol analyzer, internet content adaptation protocol, icap, https plain text", "version": "master", "depends": ["bro >=2.5.0"], "test_cmd": null, "build_cmd": "./configure --bro-dist=%(bro_dist)s && make", "url": "https://github.com/mitre/icap", "summary": null, "script_dir": "scripts", "plugin_dir": null, "readme": "===============================\nICAP Analyzer for Bro and Zeek\n===============================\n\nCopyright 2016 The MITRE Corporation.  All rights reserved.\nApproved for public release.  Distribution unlimited.  Case number 16-3871.\n\n==================\nIntroduction\n==================\nInternet Content Adaptation Protocol (ICAP) Analyzer for the Bro and Zeek \nNetwork Security Monitor.\n\nThe ICAP Analyzer was developed on a Bro v2.4.1 platform with BinPAC \nv0.44, using the BinPAC Quick Start guide, and compiled directly into\nthe Bro core.  Recommended for use with Bro v2.4.1 or later.\n\nThe ICAP Analyzer Plugin was developed on a Bro v2.5-draft platform.\nThe Plugin is NOT recommended for Bro v2.4.1 or earlier.  Requires\nBro v2.5 or later.\n\nFor more information about the ICAP analyzer, see the BroCon'16 abstract \nand presentation slides posted on the Bro website, at the following URL:\n  - https://www.bro.org/community/brocon2016.html\n\nFor more information about the ICAP protocol itself, see RFC 3507, dated \nApril 2003, along with the additional references listed below:\n  - https://tools.ietf.org/html/rfc3507\n  - https://tools.ietf.org/html/draft-stecher-icap-subid-00\n  - https://www.icap-forum.org/documents/specifications/\n    draft-icap-ext-partial-content-07.txt\n\nFor more information on Bro Packages and Bro Plugins, see the following \nreferences:\n  - https://github.com/bro/package-manager\n  - https://www.bro.org/sphinx/devel/plugins.html\n\n\n==============================\nInstallation - \nPlugin via Package Manager *\n==============================\n\nTo install the ICAP Analyzer as a Plugin, use the Bro Package Manager to\ninstall the ICAP Analyzer Plugin on Bro v2.5 or later.\n\nFor more information on how to install Bro Packages, see the following\nreference:\n  - https://github.com/bro/package-manager\n\n\n  * NOTE 1: Requires Bro v2.5 or later.\n    NOTE 2: On Bro v2.4.1, the Plugin encounters a discrepancy within\n    Bro's built-in regular-expression pattern-matching functionality,\n    and the ICAP packets parse incorrectly.  This behavior is observed\n    on v2.4.1 only when the ICAP Analyzer is implemented as a Plugin.\n    This behavior is not observed on v2.4.1 when the ICAP Analyzer is\n    compiled directly into the Bro core.  This issue appears to be\n    fixed on v2.5-beta.\n\n\n==============================\nInstallation - \nPlugin via Manual Method *\n==============================\n\nTo install the ICAP Analyzer as a Plugin manually, see the Bro Plugin\ndocumentation at the following URL:\n  - https://www.bro.org/sphinx/devel/plugins.html\n\n\n  * NOTE 1: Requires Bro v2.5 or later.\n    NOTE 2: On Bro v2.4.1, the Plugin encounters a discrepancy within\n    Bro's built-in regular-expression pattern-matching functionality,\n    and the ICAP packets parse incorrectly.  This behavior is observed\n    on v2.4.1 only when the ICAP Analyzer is implemented as a Plugin.\n    This behavior is not observed on v2.4.1 when the ICAP Analyzer is\n    compiled directly into the Bro core.  This issue appears to be\n    fixed on v2.5-beta.\n\n\n==============================\nInstallation - \nCompile into Bro Core\n==============================\n\nTo compile the ICAP Analyzer directly into the Bro core, follow Steps 1 \nthru 8 below.  Recommended for use with Bro v2.4.1 or later.\n\nThe expression <bro_distro> denotes the path of the Bro distribution, \nsuch as /opt/bro-2.4.1.\n\nThe expression <bro_install> denotes the installation path after running\n'make install' on the source code, such as /usr/local/bro.\n\n\n--------------\nStep 1 - Root.\n--------------\n1.1 Change to the root account.\n\n1.2 Proceed to Step 2.\n\n\n------------------------------------------------\nStep 2 - Copy Source Files into Bro Source Tree.\n------------------------------------------------\n2.1 Create ICAP directories in the Bro source tree:\n    mkdir <bro_distro>/src/analyzer/protocol/icap\n    mkdir <bro_distro>/scripts/base/protocols/icap\n\n2.2 Copy the following ICAP files into the Bro src directory <bro_distro>/src/analyzer/protocol/icap:\n    ./CHANGES\n    ./COPYING\n    ./README\n    ./VERSION\n    ./src/CMakeLists.txt*\n    ./src/ICAP.cc\n    ./src/ICAP.h\n    ./src/Plugin.cc\n    ./src/events.bif\n    ./src/icap.pac\n    ./src/icap-analyzer.pac\n    ./src/icap-analyzer-http.pac\n    ./src/icap-analyzer-utils.pac\n    ./src/icap-protocol.pac\n\n  * NOTE: This file './src/CMakeLists.txt' is used for compiling the\n    ICAP Analyzer into the Bro Core.  The other file './CMakeLists.txt'\n    is used for building is as a Plugin.\n \n2.3 Copy the following ICAP files into the Bro scripts directory <bro_distro>/scripts/base/protocols/icap:\n    ./scripts/__load__.bro\n    ./scripts/dpd.bro\n    ./scripts/main.bro\n\n2.4 Proceed to Step 3.\n\n\n-----------------------------\nStep 3 - Edit Bro Build List.\n-----------------------------\n3.1 Edit the Bro file <bro_distro>src/analyzer/protocol/CMakelists.txt*\n    to add the following statement (in alphabetical order, between http\n    and icmp):\n    add_subdirectory(icap)\n\n  * NOTE: This is NOT the same file copied onto Bro in Step 2.2.\n    This file has the same name, but it is already on the system, \n    one directory up.\n\n3.2 Save changes.\n\n3.3 Proceed to Step 4.\n\n\n-------------------------------\nStep 4 - Edit Bro Startup List.\n-------------------------------\n4.1 Edit the Bro file <bro_distro>/scripts/base/init-default.bro \n    to add the following statement (in alphabetical order, between http\n    and irc):\n    @load base/protocols/icap\n\n4.2 Save changes.\n\n4.3 Proceed to Step 5.\n\n\n------------------------------------------------\nStep 5 - Add Custom Scripts to Bro Startup List.\n------------------------------------------------\n5.1 [Optional] Edit the Bro file <bro_install>/share/bro/site/local.bro\n    to load any custom Bro scripts related to ICAP analysis.\n\n5.2 [Optional] Save changes.\n\n5.3 Proceed to Step 6.\n\n\n---------------------\nStep 6 - Re-Make Bro.\n---------------------\n6.1 If Bro is already running, stop Bro, via the following command:\n    <bro_install>/bin/broctl stop\n\n6.2 Configure, make & install Bro:\n    cd <bro_distro>\n    ./configure  (NOTE: include any flags/options, if applicable)\n    make\n    make install\n\n6.3 [Optional] If using PF_RING, confirm Bro is linked with PF_RING \n    libpcap:\n    ldd <bro_install>/bin/bro | grep pcap\n\n6.4 Proceed to Step 7.\n\n\n-------------------------------------\nStep 7 - Re-Start Bro via BroControl.\n-------------------------------------\n7.1 Start Bro:\n    <bro_install>/bin/broctl deploy\n\n7.2 Confirm Bro is running:\n    <bro_install>/bin/broctl status\n\n7.3 Confirm ICAP Analyzer is active:\n    <bro_install>/bin/bro -N | grep ICAP\n\n7.4 Proceed to Step 8.\n\n\n--------------\nStep 8 - Done.\n--------------\n8.1  Installation complete.  No further action required.\n\n\n#end README\n"}