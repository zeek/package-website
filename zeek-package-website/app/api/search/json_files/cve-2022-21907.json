{"description": "A package to detect CVE-2022-21907", "tags": null, "version": "v0.1.2", "depends": null, "test_cmd": null, "build_cmd": null, "url": "https://github.com/corelight/cve-2022-21907", "summary": "A package to detect CVE-2022-21907", "script_dir": "scripts", "plugin_dir": null, "readme": "## CVE-2022-21907\n\nThis package will detect exploits of [CVE-2022-21907](https://raw.githubusercontent.com/corelight/cve-2022-21907/master/http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-21907)\n\nhttps://corelight.com/blog/detecting-cve-2022-21907  \n\n#### Detection Method:\n\n- HTTP\n    - HTTP data must be >= 1750 bytes, and\n    - The `HTTP/1.1` is not observed at the end of the exploit HTTP request.\n\n#### Usage:\n\n```\n$ zeek -Cr your.pcap packages\n\n$ cat notice.log \n#separator \\x09\n#set_separator\t,\n#empty_field\t(empty)\n#unset_field\t-\n#path\tnotice\n#open\t2022-01-12-06-58-39\n#fields\tts\tuid\tid.orig_h\tid.orig_p\tid.resp_h\tid.resp_p\tfuid\tfile_mime_type\tfile_desc\tproto\tnote\tmsg\tsub\tsrc\tdst\tp\tn\tpeer_descr\tactions\temail_dest\tsuppress_for\tremote_location.country_code\tremote_location.region\tremote_location.city\tremote_location.latitude\tremote_location.longitude\n#types\ttime\tstring\taddr\tport\taddr\tport\tstring\tstring\tstring\tenum\tenum\tstring\tstring\taddr\taddr\tport\tcount\tstring\tset[enum]\tset[string]\tinterval\tstring\tstring\tstring\tdouble\tdouble\n1641934050.661549\tC3zB9u3LtTMmn7XGab\t192.168.88.1\t55193\t192.168.88.149\t80\t-\t-\t-\ttcp\tCVE_2022_21907::CVE_2022_21907_EXPLOIT_ATTEMPT\tPossible CVE_2022_21907 exploit over HTTP, multiple sprays followed by the triggering malformed request\tget_current_packet data=\\x00\\x0c)\\x9a\\x86\\xd9\\xa6\\x83\\xe7\\xba\\xc9g\\x08\\x00E\\x00\\x00\\xd4\\x00\\x00@\\x00@\\x06\\x00\\x00\\xc0\\xa8X\\x01\\xc0\\xa8X\\x95\\xd7\\x99\\x00P\\xdf\\xfbo\\xde\\xb8Y\\x1d\\x01\\x80\\x18\\x08\\x002\\xae\\x00\\x00\\x01\\x01\\x08\\x0a\\xf5\\x16\\x9c\\xb8\\x00*\\xddvGET / HTTP/1.1\\x0aHost: 192.168.88.149:80\\x0aCache-Control: no-cache\\x0a\\x0aGET /l;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\\x0a\\x0a\t192.168.88.1\t192.168.88.149\t80\t-\t-\tNotice::ACTION_LOG\t(empty)3600.000000\t-\t-\t-\t-\t-\n#close\t2022-01-12-06-58-44\n```"}