{"description": "This script expands the base known-hosts policy to include reverse DNS queries and syncs it across all workers.", "tags": "known-hosts, known_hosts, dns", "version": "v1.2.4", "depends": null, "test_cmd": "cd tests && btest -d known_tests", "build_cmd": null, "url": "https://github.com/dopheide-esnet/zeek-known-hosts-with-dns", "summary": null, "script_dir": "scripts", "plugin_dir": null, "readme": "# zeek-known-hosts-with-dns\n\nUsage:\nYou will need to @unload (or comment out) the base protocols/conn/known-hosts\npolicy.  It's recommended to keep \"const host_tracking = LOCAL_HOSTS\" so\nZeek doesn't try to keep DNS information for all external hosts as well.\n\nDescription:\nThis script expands the base known-hosts policy to include reverse DNS queries\nand syncs it across all workers.  Since this is not just a known_hosts log\nfile, it's important to recognize this will increase memory usage relative to\nthe amount of hosts that are being tracked.\n\nThe initial motivation for this policy was to remove the need for the majority\nof the asynchronous DNS calls by protocols/ssh/interesting-hostnames.zeek.\nHowever, since there may be other cases where the known DNS data is useful,\nit was decided to offer them as two separate packages.\n\nIn our environment, with lots of automated processes ssh'ing into systems,\nthe combination of these two policies reduces the asynch DNS calls by 99%.\n\nIn some cases you may want to:\nredef Known::ssh_auth_only=T;\n\nTesting:\nAfter loading the policy, you can check the current list of known hosts using:\n\nbroctl print Known::hosts\nor\nzeekctl print Known::hosts\n\nAnother thing to note is that it defaults to using a persistent Broker store\nthat will be reloaded and sent to the workers at startup.\n\n\n"}