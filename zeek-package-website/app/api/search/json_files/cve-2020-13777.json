{"description": "\"Test script for CVE-2020-13777. Please read Readme.\"", "tags": null, "version": "main", "depends": null, "test_cmd": "cd testing && btest -d", "build_cmd": null, "url": "https://github.com/0xxon/cve-2020-13777", "summary": null, "script_dir": "scripts", "plugin_dir": null, "readme": "Zeek test script for CVE-2020-13777\n===================================\n\nThis script performs a simple test to check if a server is potentially vulnerable to CVE-2020-13777.\n\nCVE-2020-13777 causes GnuTLS to create unencrypted session tickets. This seems to be detectable by checking gnutls sets the ``key_name`` to zero - for which it uses the first 16 bytes of the session-ticket. This script checks if:\n\n* A server sends a suspicious session ticket\n* A client resumes a connection to a server succesfully with a suspicious session ticket\n\nBoth cases indicate that a server is employing a vulnerable version of GnuTLS.\n\nFound cases are written to notice.log. Example output:\n\n```\n1591660828.497706\tCHhAvVGS1DHFjwGM9\t::1\t58800\t::1\t5556\t-\t-\t-\ttcp\tCVE_2020_13777::CVE_2020_13777_Server\tServer potentially vulnerable to CVE-2020-13777 detected\t-\t::1\t::1\t5556\t-\t-\tNotice::ACTION_LOG\t3600.000000\t-\t-\t-\t-\t-\n1591660837.423412\tClEkJM2Vm5giqnMf4h\t::1\t58802\t::1\t5556\t-\t-\t-\ttcp\tCVE_2020_13777::CVE_2020_13777_Resumed\tServer potentially vulnerable to CVE-2020-13777 detected; client resumed with suspicious session ticket\t-\t::1\t::1\t5556\t-\t-\tNotice::ACTION_LOG\t3600.000000\t-\t-\t-\t-\t-\n```\n\nNotice are deduplicated and only logged once per default_suppression_interval (default: 1 hour) for each server.\n\nTo install via zkg, just use\n\n```\nzkg install 0xxon/cve-2020-0601\n```\n\nNote:\n----\nThis script only works for TLS 1.2 (or below) connections. It will not alert on vulnerable servers that use TLS 1.3. The \n\nDisclaimer:\n-----------\n\nThis script has not been extensively tested. It works with my self-generated test-data and should find vulnerable servers. There is a chance that it will raise false positives with different server software, but this is somewhat unlikely."}