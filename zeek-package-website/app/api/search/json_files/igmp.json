{"description": "A Spicy-based packet analyzer for the IGMP protocol.", "tags": "igmp, zeek, spicy, packet analyzer, ids", "version": "main", "depends": ["zeek >=4.0.0"], "test_cmd": "cd testing && btest -c btest.cfg", "build_cmd": "mkdir -p build && cd build && SPICYZ=$(command -v spicyz || echo %(package_base)s/spicy-plugin/build/bin/spicyz) cmake .. && cmake --build .", "url": "https://github.com/zeek-plugins/igmp", "summary": "IGMP packet analyzer in Spicy", "script_dir": "scripts", "plugin_dir": null, "readme": "# Spicy-based Zeek IGMP packet analyzer :hot_pepper:\n\nThis repository contains a [Zeek](https://zeek.org/) packet analyzer for the [IGMP protocol](https://en.wikipedia.org/wiki/Internet_Group_Management_Protocol), based on [Spicy](https://docs.zeek.org/projects/spicy/en/latest/index.html).\nIt is packed as a Zeek package, which can be easily installed with [Zeek Package Manager](https://docs.zeek.org/projects/package-manager/en/stable/).\n\nThe IGMP protocol is defined in the following RFCs:\n- IGMPv1: [RFC 1112](https://datatracker.ietf.org/doc/html/rfc1112)\n- IGMPv2: [RFC 2236](https://datatracker.ietf.org/doc/html/rfc2236)\n- IGMPv3: [RFC 3376](https://datatracker.ietf.org/doc/html/rfc3376)\n\n\n## Installation\n\n### Prerequisites\n\nBefore trying to install the package, make sure you have the following tools installed:\n\n- [Zeek](https://zeek.org/)\n- [Zeek Package Manager](https://docs.zeek.org/projects/package-manager/en/stable/) command `zkg`\n- [Spicy plugin](https://docs.zeek.org/projects/spicy/en/latest/index.html) for Zeek\n\nEverything should be installed correctly if you install the latest [Zeek](https://zeek.org/) version.\n\n\n### Setup\n\nA simple call to `make install` from the repository's root directory should install the package and run unit tests.\nYou can also use the `zkg` command directly:\n```shell\nzkg install https://github.com/zeek-plugins/igmp  # to install as super user\nzkg --user install https://github.com/zeek-plugins/igmp  # to install in user space\n```\n\nYou might have to update the `ZEEKPATH` and `ZEEK_PLUGIN_PATH` environmental variables.\nTo see which value they should take, run the following commands:\n```shell\nzkg env         # For the super user\nzkg --user env  # For a normal user\n```\n\nTo confirm that installation was successful, you can run the following command:\n```shell\nzeek -NN | grep IGMP\n```\n\nIf the command's output shows something similar to:\n```\n[Packet Analyzer] Spicy::IGMP (ANALYZER_SPICY__IGMP)\n```\nthe package was correctly installed, and you have access to the IGMP packet analyzer.\n\nIn the case of any installation problems, please check the [Zeek Package Manager](https://docs.zeek.org/projects/package-manager/en/stable/) documentation.\n\n\n## Usage\n\nOnce the Zeek package installed, you will be able to use the IGMP packet analyzer in your Zeek scripts.\nYou will have to explicitly load the package scripts in the beginning of your Zeek scripts with the following instruction:\n```zeek\n@load /path/to/igmp/scripts\n```\nIf you updated the `ZEEKPATH` environment variable as explained before, the path should simply be `igmp`.\n\n\n### Types\n\nThe plugin defines the following types:\n```zeek\nIGMP::IgmpMessageType: enum {\n  MEMBERSHIP_QUERY     = 0x11,\n  MEMBERSHIP_REPORT_V1 = 0x12,\n  MEMBERSHIP_REPORT_V2 = 0x16,\n  LEAVE_GROUP          = 0x17,\n  MEMBERSHIP_REPORT_V3 = 0x22,\n  BAD_CHECKSUM         = 0x00\n}\n```\n- Represents an IGMP Message Type.\n- This plugin includes a dummy IGMP message type, `IGMP::BAD_CHECKSUM`, that is indicated when checksum verification failed on the message.\n\n```zeek\nIGMP::MulticastGroup: record {\n  group_type:     GroupType;\n  aux_data_len:   count;\n  num_sources:    count;\n  multicast_addr: addr;\n  sources:        vector of addr;\n  aux_data:       string;\n}\n```\n- Represents an IGMPv3 Multicast Group.\n\n```zeek\nIGMP::GroupType: enum {\n  MODE_IS_INCLUDE        = 1,\n  MODE_IS_EXCLUDE        = 2,\n  CHANGE_TO_INCLUDE_MODE = 3,\n  CHANGE_TO_EXCLUDE_MODE = 4,\n  ALLOW_NEW_SOURCES      = 5,\n  BLOCK_OLD_SOURCES      = 6\n}\n```\n- Represents an IGMPv3 Multicast Group type.\n\nPlease consult [RFC 1112](https://datatracker.ietf.org/doc/html/rfc1112) (IGMPv1), [RFC 2236](https://datatracker.ietf.org/doc/html/rfc2236) (IGMPv2) and [RFC 3376](https://datatracker.ietf.org/doc/html/rfc3376) (IGMPv3) for more information.\n\n\n### Events\n\nThe plugin defines the following events:\n- `event igmp::message(pkt_hdr: raw_pkt_hdr, msg_type: IGMP::IgmpMessageType)`\n  - Triggered upon reception of any IGMP message.\n- `event igmp::membership_query(pkt_hdr: raw_pkt_hdr, group_addr: addr)`\n  - Triggered upon reception of a IGMP Membership Query message.\n- `event igmp::membership_report_v1(pkt_hdr: raw_pkt_hdr, group_addr: addr)`\n  - Triggered upon reception of a IGMP Version 1 Membership Report message.\n- `event igmp::membership_report_v2(pkt_hdr: raw_pkt_hdr, group_addr: addr)`\n  - Triggered upon reception of a IGMP Version 2 Membership Report message.\n- `event igmp::leave_group(pkt_hdr: raw_pkt_hdr, group_addr: addr)`\n  - Triggered upon reception of a IGMP Version 2 Leave Group message.\n- `event igmp::membership_report_v3(pkt_hdr: raw_pkt_hdr, num_groups: count, groups: vector of IGMP::MulticastGroup)`\n  - Triggered upon reception of a IGMP Version 3 Membership Report message.\n- `event igmp::bad_checksum(pkt_hdr: raw_pkt_hdr, transmitted_checksum: count, computed_checksum: count)`\n  - Triggered upon reception of a IGMP message which failed checksum verification.\n\n\n### Logging\n\nThe plugin automatically logs all the IGMP traffic that it sees, and writes it into the `igmp.log` file.\nFor every message, it logs the following information:\n- Timestamp\n- Source IPv4 address\n- Destination IPv4 address\n- IGMP message type (see the aforementioned RFCs for more information)\n  - This analyzer includes a dummy IGMP message type, `IGMP::BAD_CHECKSUM`, that is indicated when checksum verification failed on the message.\n\n\n## License\n\nThis project is licensed under the BSD license. See the [LICENSE](https://raw.githubusercontent.com/zeek-plugins/igmp/master/LICENSE) file for details.\n\n\n## Contributors\n\n- Fran\u00e7ois De Keersmaeker\n  - GitHub: [@fdekeers](https://github.com/fdekeers)\n  - Email: francois.dekeersmaeker@uclouvain.be\n"}