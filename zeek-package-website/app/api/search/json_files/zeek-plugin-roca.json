{"description": "Identify certificates potentially affected by CVE-2017-15361", "tags": "certificates, CVE-2017-15361", "version": "0.0.1", "depends": null, "test_cmd": "cd tests && btest -d", "build_cmd": "( ./configure --bro-dist=%(bro_dist)s && make )", "url": "https://github.com/0xxon/zeek-plugin-roca", "summary": null, "script_dir": null, "plugin_dir": "build/Johanna_ROCA.tgz", "readme": "\nJohanna::ROCA\n=============\n\nThis plugin implements detection of CVE-2017-15361 keys; it is a\nreimplementation of the source available at\nhttps://github.com/crocs-muni/roca.\n\nThis plugin provides two new BIFs that can check public keys:\n\n* `roca_vulnerable_cert` checks if a certificate is vulnerable\n* `roca_vulnerable_mod` checks if a modulus is vulerable.\n\nThis plugin also ships with a script that is automatically loaded\nand can notify you when CVE-2017-15361 are encountered on the wire.\n\nTo enable this, set:\n\n```\nredef ROCA::Notify=T;\n```\n\nAfterwards you should get notice.log entries when such keys are encountered.\nExample:\n\n```\n#separator \\x09\n#set_separator\t,\n#empty_field\t(empty)\n#unset_field\t-\n#path\tnotice\n#open\t2017-10-25-00-59-28\n#fields\tts\tuid\tid.orig_h\tid.orig_p\tid.resp_h\tid.resp_p\tfuid\tfile_mime_type\tfile_desc\tproto\tnote\tmsg\tsub\tsrc\tdst\tp\tn\tpeer_descr\tactions\tsuppress_for\tdropped\tremote_location.country_code\tremote_location.region\tremote_location.city\tremote_location.latitude\tremote_location.longitude\n#types\ttime\tstring\taddr\tport\taddr\tport\tstring\tstring\tstring\tenum\tenum\tstring\tstring\taddr\taddr\tport\tcount\tstring\tset[enum]\tinterval\tbool\tstring\tstring\tstring\tdouble\tdouble\n1449265638.475275\tCHhAvVGS1DHFjwGM9\t192.168.6.74\t52122\t104.236.167.107\t4433\tFvv5qY2DMGQY2MYQ03\tapplication/x-x509-user-cert\t104.236.167.107:4433/tcp\ttcp\tROCA::CVE_2017_15361_KEY\tCertificate uses a key potentially affected by CVE-2017-15361\t-\t192.168.6.74\t104.236.167.107\t4433\t-\tbro\tNotice::ACTION_LOG\t86400.000000\tF\t-\t-\t-\t-\t-\n#close\t2017-10-25-00-59-28\n```\n\nInstallation\n------------\n\nThis plugin requires GMP (The GNU MP Bugnum Library) to be installed on the\nsystem. If this is the case, you should be able to install it using bro-pkg\nusing:\n\n```\nbro-pkg install 0xxon/bro-plugin-roca\n```\n\nIf you have to specify the path to gmp, you can manually clone the repository\nand install it using:\n\n```\n./configure --with-gmp=[directory]\nmake install\n```\n"}