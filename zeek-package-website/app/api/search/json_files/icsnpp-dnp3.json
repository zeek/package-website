{"description": "DNP3 script for detailed logging of the DNP3 protocol - CISA ICSNPP", "tags": "dnp3, DNP3, ics, ICS, CISA, INL, ICSNPP, icsnpp, zeek scripting, log writer, protocol analyzer", "version": "main", "depends": null, "test_cmd": "cd tests && btest -c btest.cfg", "build_cmd": null, "url": "https://github.com/cisagov/icsnpp-dnp3", "summary": null, "script_dir": "scripts", "plugin_dir": null, "readme": "# ICSNPP-DNP3\n\nIndustrial Control Systems Network Protocol Parsers (ICSNPP) - DNP3.\n\n## Overview\n\nICSNPP-DNP3 is a Zeek package that extends the logging capabilities of Zeek's default DNP3 protocol parser.\n\nZeek's default DNP3 parser logs DNP3 traffic to dnp3.log. This log file remains unchanged. This package extends DNP3 logging capability by adding two new DNP3 log files:\n* dnp3_control.log\n* dnp3_objects.log\n\nFor additional information on these log files, see the *Logging Capabilities* section below.\n\n## Installation\n\n### Package Manager\n\nThis script is available as a package for [Zeek Package Manger](https://docs.zeek.org/projects/package-manager/en/stable/index.html)\n\n```bash\nzkg refresh\nzkg install icsnpp-dnp3\n```\n\nIf you have ZKG configured to load packages (see @load packages in quickstart guide), this script will automatically be loaded and ready to go.\n[ZKG Quickstart Guide](https://docs.zeek.org/projects/package-manager/en/stable/quickstart.html)\n\nIf you are not using site/local.zeek or another site installation of Zeek and just want to run this script on a packet capture you can add `icsnpp-dnp3` to your command to run this script on the packet capture:\n\n```bash\ngit clone https://github.com/cisagov/icsnpp-dnp3.git\nzeek -Cr icsnpp-dnp3/tests/traces/dnp3_example.pcap icsnpp-dnp3\n```\n\n### Manual Install\n\nTo install this script manually, clone this repository and copy the contents of the scripts directory into `${ZEEK_INSTALLATION_DIR}/share/zeek/site/icsnpp-dnp3`.\n\n```bash\ngit clone https://github.com/cisagov/icsnpp-dnp3.git\nzeek_install_dir=$(dirname $(dirname `which zeek`))\ncp -r icsnpp-dnp3/scripts/ $zeek_install_dir/share/zeek/site/icsnpp-dnp3\n```\n\nIf you are using a site deployment, simply add echo `@load icsnpp-dnp3` to your local.site file.\n\nIf you are not using site/local.zeek or another site installation of Zeek and just want to run this package on a packet capture you can add `icsnpp-dnp3` to your command to run this plugin's scripts on the packet capture:\n\n```bash\nzeek -Cr icsnpp-dnp3/tests/traces/dnp3_example.pcap icsnpp-dnp3\n```\n## Logging Capabilities\n\n### DNP3 Control Log (dnp3_control.log)\n\n#### Overview\n\nThis log captures DNP3 Control Relay Output Block and Pattern Control Block data seen in SELECT-OPERATE-RESPONSE commands and logs them to **dnp3_control.log**.\n\nDNP3 Control Relay Output Blocks can be controlled via DNP3 SELECT and OPERATE commands and are among the most common (and most impactful) DNP3 commands.\n\nThis log file contains all the relevant data for these SELECT and OPERATE commands (as well as the responses) and shows a more in-depth look at these commands and provides a much more detailed look as to what operational DNP3 commands are being sent.\n\n#### Fields Captured:\n\n| Field                 | Type      | Description                                               |\n| --------------------- |-----------|-----------------------------------------------------------|\n| ts                    | time      | Timestamp                                                 |\n| uid                   | string    | Unique ID for this connection                             |\n| id                    | conn_id   | Default Zeek connection info (IP addresses, ports)        |\n| block_type            | string    | Control_Relay_Output_Block or Pattern_Control_Block       |\n| function_code         | string    | Function Code (SELECT, OPERATE, RESPONSE)                 |\n| index_number          | count     | Object Index #                                            |\n| trip_control_code     | string    | Nul, Close, or Trip                                       |\n| operation_type        | string    | Nul, Pulse_On, Pulse_Off, Latch_On, Latch_Off             |\n| execute_count         | count     | Number of times to execute                                |\n| on_time               | count     | On Time                                                   |\n| off_time              | count     | Off Time                                                  |\n| status_code           | string    | Status Code                                               |\n\n### DNP3 Read Object Log (dnp3_read_objects.log)\n\n#### Overview\n\nThis log captures DNP3 Read Object data seen in READ-RESPONSE commands and logs them to **dnp3_objects.log**.\n\nDNP3 READ-RESPONSE commands are very common DNP3 commands and these responses contain a lot of useful information about the DNP3 devices.\n\n#### Fields Captured\n\n| Field                 | Type      | Description                                           |\n| --------------------- |-----------|-------------------------------------------------------|\n| ts                    | time      | Timestamp                                             |\n| uid                   | string    | Unique ID for this connection                         |\n| id                    | conn_id   | Default Zeek connection info (IP addresses, ports)    |\n| function_code         | string    | Function Code (READ or RESPONSE)                      |\n| object_type           | string    | DNP3 Object type                                      |\n| object_count          | count     | Number of objects                                     |\n| range_low             | count     | Range (Low) of object                                 |\n| range_high            | count     | Range (High) of object                                |\n\n## ICSNPP Packages\n\nAll ICSNPP Packages:\n* [ICSNPP](https://github.com/cisagov/icsnpp)\n\nFull ICS Protocol Parsers:\n* [BACnet](https://github.com/cisagov/icsnpp-bacnet)\n    * Full Zeek protocol parser for BACnet (Building Control and Automation)\n* [BSAP](https://github.com/cisagov/icsnpp-bsap)\n    * Full Zeek protocol parser for BSAP (Bristol Standard Asynchronous Protocol) over IP\n    * Full Zeek protocol parser for BSAP Serial comm converted using serial tap device\n* [Ethercat](https://github.com/cisagov/icsnpp-ethercat)\n    * Full Zeek protocol parser for Ethercat\n* [Ethernet/IP and CIP](https://github.com/cisagov/icsnpp-enip)\n    * Full Zeek protocol parser for Ethernet/IP and CIP\n* [Genisys](https://github.com/cisagov/icsnpp-genisys)\n    * Full Zeek protocol parser for Genisys\n* [OPCUA-Binary](https://github.com/cisagov/icsnpp-opcua-binary)\n    * Full Zeek protocol parser for OPC UA (OPC Unified Architecture) - Binary\n* [S7Comm](https://github.com/cisagov/icsnpp-s7comm)\n    * Full Zeek protocol parser for S7comm, S7comm-plus, and COTP\n* [Synchrophasor](https://github.com/cisagov/icsnpp-synchrophasor)\n    * Full Zeek protocol parser for Synchrophasor Data Transfer for Power Systems (C37.118)\n\nUpdates to Zeek ICS Protocol Parsers:\n* [DNP3](https://github.com/cisagov/icsnpp-dnp3)\n    * DNP3 Zeek script extending logging capabilities of Zeek's default DNP3 protocol parser\n* [Modbus](https://github.com/cisagov/icsnpp-modbus)\n    * Modbus Zeek script extending logging capabilities of Zeek's default Modbus protocol parser\n\n### Other Software\nIdaho National Laboratory is a cutting edge research facility which is a constantly producing high quality research and software. Feel free to take a look at our other software and scientific offerings at:\n\n[Primary Technology Offerings Page](https://www.inl.gov/inl-initiatives/technology-deployment)\n\n[Supported Open Source Software](https://github.com/idaholab)\n\n[Raw Experiment Open Source Software](https://github.com/IdahoLabResearch)\n\n[Unsupported Open Source Software](https://github.com/IdahoLabCuttingBoard)\n\n### License\n\nCopyright 2023 Battelle Energy Alliance, LLC\n\nLicensed under the 3-Part BSD (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n  https://opensource.org/licenses/BSD-3-Clause\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n\n\n\n\nLicensing\n-----\nThis software is licensed under the terms you may find in the file named \"LICENSE\" in this directory.\n\nYou agree your contributions are submitted under the BSD-3-Clause license. You represent you are authorized to make the contributions and grant the license. If your employer has rights to intellectual property that includes your contributions, you represent that you have received permission to make contributions and grant the required license on behalf of that employer.\n"}