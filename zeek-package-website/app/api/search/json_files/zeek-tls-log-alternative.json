{"description": "\"This package generates a file called tls.log. The difference from ssl.log is that it is much more focused on logging all kinds of protocol features. This can be interesting for academic purposes - or if one is just interested in more information about specific features used in local TLS traffic.\"", "tags": "TLS, SSL, X509, Certificates, PKI", "version": "main", "depends": null, "test_cmd": "cd tests && make", "build_cmd": null, "url": "https://github.com/0xxon/zeek-tls-log-alternative", "summary": null, "script_dir": "scripts", "plugin_dir": null, "readme": "# TLS Log Alternative\n\nThis package provides a log alternative to the traditional ```ssl.log```, which is provided by Zeek by default. If you load this package, you will get one (or optionally two) additional log files that provide a lot more information about the TLS handshake.\n\nLoading this script by default will create a new ```tls.log``` file. This file contains a lot of low-level details of the handshake. For more details, please see ```tls.zeek``` in ```scripts```, which has documentation for every field. Example log output:\n\n```\n#fields\tts\tuid\tid.orig_h\tid.orig_p\tid.resp_h\tid.resp_p\tserver_version\tclient_version\tcipher\tclient_ciphers\tsni\tssl_client_exts\tssl_server_exts\tticket_lifetime_hint\tserver_certs\tclient_certs\tssl_established\tdh_param_size\tpoint_formats\tclient_curves\tcurve\torig_alpn\tresp_alpn\talert\tclient_supported_versions\tserver_supported_version\tpsk_key_exchange_modes\tclient_key_share_groups\tserver_key_share_group\tclient_comp_methods\tsigalgs\thashalgs\n#types\ttime\tstring\taddr\tport\taddr\tport\tcount\tcount\tcount\tvector[count]\tvector[string]\tvector[count]\tvector[count]\tcount\tvector[string]vector[string]\tbool\tcount\tvector[count]\tvector[count]\tcount\tvector[string]\tvector[string]\tvector[count]\tvector[count]\tcount\tvector[count]\tvector[count]\tcount\tvector[count]\tvector[count]\tvector[count]\n1491407508.244862\tC59DC42iW3polXuIef\t192.168.6.240\t65503\t139.162.123.134\t13443\t32531\t771\t4866\t49196,49200,159,52393,52392,52394,49195,49199,158,49188,49192,107,49187,49191,103,49162,49172,57,49161,49171,51,157,156,4866,4867,4865,61,60,53,47,255\t-\t11,10,35,13,22,23,43,45,40\t40\t-\t--\tF\t-\t0,1,2\t29,23,25,24\t-\t-\t-\t-\t32531,771,770,769\t-\t1,0\t29\t29\t0\t3,3,3,4,5,6,1,1,1,3,1,2,2,2,2\t4,5,6,8,8,8,4,5,6,2,2,2,4,5,6\n1491407512.852869\tC3tAYa2eYDO4qZFDie\t192.168.6.240\t65504\t139.162.123.134\t13443\t32531\t771\t4866\t49196,49200,159,52393,52392,52394,49195,49199,158,49188,49192,107,49187,49191,103,49162,49172,57,49161,49171,51,157,156,4866,4867,4865,61,60,53,47,255\t-\t11,10,35,13,22,23,43,45,40,42,41\t40,41--\t-\tF\t-\t0,1,2\t29,23,25,24\t-\t-\t-\t-\t32531,771,770,769\t-\t1,0\t29\t29\t0\t3,3,3,4,5,6,1,1,1,3,1,2,2,2,2\t4,5,6,8,8,8,4,5,6,2,2,2,4,5,6\n```\n\nIf you re-define the option ```TLSLog::log_certificates``` to true, you also get a second log file called ```tls_certificates.log```, which contains a base64-encoded version of all certificates that are sent over the wire.\n\nBy default, certificate hashes are provided as sha256. If you want to use a different hash algorithm, you can redef ```TLSLog::hash_function``` to a different hash function, e.g. to ```sha1_hash```.\n\nThe easiest way to install this pacjage is by using the package manager; just do\n\n```\nzkg install 0xxon/tls-log-alternative\n```\n"}