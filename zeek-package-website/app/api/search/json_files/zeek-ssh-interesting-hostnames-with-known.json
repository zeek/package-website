{"description": "This script replaces the default ssh/interesting-hostnames and reduces the number of asyncrhonous when() calls made by Zeek.", "tags": "dns, ssh, interesting-hostnames", "version": "v1.2.1", "depends": null, "test_cmd": "cd tests && btest -d ssh_tests", "build_cmd": null, "url": "https://github.com/dopheide-esnet/zeek-ssh-interesting-hostnames-with-known", "summary": null, "script_dir": "scripts", "plugin_dir": null, "readme": "# zeek-ssh-interesting-hostnames-with-known\n\nThis package requires zeek-known-hosts-with-dns.  You will also need comment\nout ssh/interesting-hostnames from the default local.bro/local.zeek file.\n\nDescription:\n\nThe default ssh/interesting-hostnames policy does dns lookups for the source\nhost of every successful ssh authentication.  In our environment, the\nmajority of ssh connections are internal and, due to automation, there\nare a lot of them.  This results in Zeek making thousands of\nasynchronous when() calls for lookup_addr().\n\nBy replacing known-hosts with known-hosts-with-dns, we keep a running\ntable of local DNS lookups.  Combined with this policy, it can reduce\nthe DNS queries from our Zeek systems by over 90%.      \n\n"}