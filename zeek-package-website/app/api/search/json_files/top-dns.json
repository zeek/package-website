{"description": "Log the top DNS queries being requested.", "tags": "dns, sumstats, log, measurement, top", "version": "master", "depends": null, "test_cmd": null, "build_cmd": null, "url": "https://github.com/corelight/top-dns", "summary": null, "script_dir": "scripts", "plugin_dir": null, "readme": "Top DNS Measurement\n===================\n\nOverview\n--------\n\nThis script uses a built in probabalistic measurement mechanism in Bro to \nmeasure the top DNS requests (by type of query, i.e., CNAME, A, AAAA, etc) being\ndone over a definable period of time.  This is logged into a new log named\n\"top_dns.log\".\n\nBy using the probabalistic mechanism, it makes this task something that can be \nachieved in a memory efficient manner and loading this script shouldn't have \nany truly significant performance impact on most deployments.\n\nInstallation\n------------\n\n::\n\n\tbro-pkg refresh\n\tbro-pkg install bro/corelight/top-dns\n\nConfiguration\n-------------\n\nIf you would like to change the logging/measurement interval, use the following\nsnippet (default is 15 minutes)::\n\n\tredef TopDNS::logging_interval = 1hr;\n\nIf you would like to log more or less than the default of 10 names for each \nquery type, you can use the following snippet::\n\n\tredef TopDNS::top_k = 20;\n\nIf you would like to add something like MX recore queries to be measured, you \ncan add the following snippet::\n\n\tredef TopDNS::records += {\"MX\"};\n\nBy default this package will measure based on the full domain.  If you'd like\nmeasure based on trimming down to the \"domain\" (www.google.co.uk would be \ntrimmed to google.co.uk), you can use the following snippet in local.bro::\n\n\tredef TopDNS::use_trimmed_domain = T;\n"}