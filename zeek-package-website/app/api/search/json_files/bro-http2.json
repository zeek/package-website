{"description": "A HTTP2 protocol analyzer for the Zeek NSM.", "tags": "zeek plugin, protocol analyzer, http2, intel", "version": "0.6.0", "depends": ["zeek >=3.0.0"], "test_cmd": "make test", "build_cmd": "./configure && make", "url": "https://github.com/MITRECND/bro-http2", "summary": null, "script_dir": "scripts", "plugin_dir": null, "readme": "# Zeek HTTP2 Analyzer Plugin\n\nThis plugin provides an HTTP2 ([RFC 7540](https://tools.ietf.org/html/rfc7540))\ndecoder/analyzer for [Zeek](https://www.zeek.org/) 4.0+. If you need\nthis capability for older instances of Zeek (Bro), i.e., 3.x, 2.6.x or older, please\nrefer to previous versions of the plugin.\n\nThe events exposed attempt to mimic the events exposed by the native HTTP analyzer\n\n------\n\n## Installation\n\n### Requirements\n\n#### Nghttp2\n\nNghttp2 1.11.0 or greater is required. The plugin uses the decompression\nlibraries and some portions of the API used are not supported prior to that\nversion.\n\n    nghttp2 Library - https://github.com/nghttp2/nghttp2\n\nOn CentOS 7:\n\n    # sudo yum install libnghttp2-devel\n\nOn Ubuntu 20.04:\n\n    # apt install libnghttp2-dev\n\nAlternatively install the library manually from the [repo](https://github.com/nghttp2/nghttp2/releases/latest).\n\n#### Brotli\n\nBrotli is required as it is used quite often by popular websites and the\nanalyzer automatically attempts to decompress data frames.\n\nOn CentOS 7:\n\n    # sudo yum install libbrotli-devel\n\nOn Ubuntu 20.04:\n\n    # apt install libbrotli-dev\n\nAlternatively install the library manually. It can be found at <https://github.com/google/brotli>.\nThe latest release can be found at <https://github.com/google/brotli/releases/latest>.\nAfter downloading the latest release, follow these steps to compile and install the library:\n\n    tar -zxvf <release file>\n    cd brotli-<version>\n    mkdir build && cd build\n    ../configure-cmake\n    make\n    make test\n    make install\n\n### Zeek Package Manager\n\nUsing the Zeek Package Manager is the recommended way to install this plugin.\nThe Zeek Package Manager (`zkg`) is included with installations of Zeek 4.0 and newer.\n\nBefore attempting to install the plugin, ensure Zeek's binary path is available in your `PATH` environment variable. For example if you installed Zeek via binary package, you would need to do:\n\n    # export PATH=$PATH:/opt/zeek/bin\n\nAfter setting the `PATH` properly, you can install the plugin using one of the following methods:\n\n* From the repo clone directory:\n\n      # zkg install .\n\n* Using the github repo directly:\n\n      # zkg install https://github.com/MITRECND/bro-http2\n\n* Using the official source:\n\n      # zkg install zeek/mitrecnd/bro-http2\n\n__NOTE__ If you had an older version of zkg or the original bro package manager\ninstalled, the path might show up as `bro/mitrecnd/bro-http2`. Please use that\npath or update your zkg configuration located, by default, in `~/.zkg/config`.\n\n### Installing Older Versions\n\nIf you are still running an older version of Zeek (Zeek 3.x, Bro 2.6.x or older), you\ncan install a previous version of the plugin using zkg, utilizing the `--version`\nargument to specify a specific source tag or branch.\nThe following will install a version compatible with Bro 2.6.x.\n\n      # zkg install zeek/mitrecnd/bro-http2 --version 0.4.2\n\n__NOTE__ While using an older version ensures compatibility with an older version of Zeek/Bro, there have been some changes and bug fixes made to the code, so performance may not be optimal and issues may arise.\n\n## Usage\n\nYou should see the following output from zeek if successfully installed:\n\n    > zeek -NN mitrecnd::HTTP2\n    mitrecnd::HTTP2 - Hypertext Transfer Protocol Version 2 analyzer (dynamic, version 0.6.0)\n        [Analyzer] HTTP2 (ANALYZER_HTTP2, enabled)\n        [Event] http2_request\n        [Event] http2_reply\n        [Event] http2_stream_start\n        [Event] http2_stream_end\n        [Event] http2_header\n        [Event] http2_all_headers\n        [Event] http2_begin_entity\n        [Event] http2_end_entity\n        [Event] http2_entity_data\n        [Event] http2_content_type\n        [Event] http2_event\n        [Event] http2_data_event\n        [Event] http2_header_event\n        [Event] http2_priority_event\n        [Event] http2_rststream_event\n        [Event] http2_settings_event\n        [Event] http2_pushpromise_event\n        [Event] http2_ping_event\n        [Event] http2_goaway_event\n        [Event] http2_windowupdate_event\n        [Event] http2_continuation_event\n        [Type] http2_settings_unrecognized_table\n        [Type] http2_settings\n        [Type] http2_stream_stat\n\nTo use/load the http2 analyzer, add the following to your config\n(e.g., local.zeek):\n\n    @load http2\n\nThe analyzer will create a new log file called \"http2.log\"\n\nTo use/load the http2 intel framework extensions add the following\nto your config:\n\n    @load http2/intel\n"}