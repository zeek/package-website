{"description": "This plugin adds a Site::is_darknet function.", "tags": "bro plugin, site, darknet", "version": "2.1", "depends": null, "test_cmd": "(cd testing && btest -d)", "build_cmd": null, "url": "https://github.com/ncsa/bro-is-darknet", "summary": null, "script_dir": "scripts", "plugin_dir": null, "readme": "# Bro Is Darknet?\nThis plugin adds a Site::is\\_darknet function.\nThis is useful for scripts that track scan attempts or other probes.\nIt can handle purely dark address space as well as honeynet space.\n\n## Configuration.\n\n### Mode\n\n`is_darknet` can operate in four different modes by `redef`ing `Site::darknet_mode` to one of these values:\n\n* `DARKNET` - Only hosts defined in darknet_address_space are dark\n* `NOT_ALLOCATED` - Only hosts NOT listed in used_address_space are dark\n* `DARKNET_OR_NOT_ALLOCATED` - Only hosts defined in darknet_address_space OR\n  NOT listed in used_address_space are dark. Useful if you reuse part of darknet\n  space for honey net purposes\n* `DARKNET_AND_NOT_ALLOCATED` - Only hosts both defined in\n  darknet_address_space AND NOT listed in used_address_space are dark. Useful if\n  your networking group may reallocate your darknet subnets out from under you.\n\n## subnet sets\n\n`is_darknet` uses two sets to determine if an address is darknet or not\n\n* `used_address_space: set[subnet]` - A set containing subnets from local_nets that are in use\n* `darknet_address_space: set[subnet]` -  A set containing subnets from local_nets that are dark\n\nYou should `redef` these in `local.bro` using something like\n\n    redef Site::used_address_space = {\n        192.168.1.0/24, 192.168.2.0/24, 192.168.4.0/24,\n        192.168.10.0/24, 192.168.11.0/24, 192.168.13.0/24,\n    };\n\nor\n\n    redef Site::darknet_address_space = {\n        192.168.0.0/24, 192.168.253.0/24, 192.168.2544.0/24,\n    };\n\n## Auto used_address_space tracking\n\nif Site::auto_manage_allocated is true this plugin will also add any host that\nit sees a bidirectional connection from to `used_address_space`.  It does this\nby first aggregating the address up to the subnet it was seen in using the\n`v4_aggregation_bits` (default 24) or `v6_aggregation_bits` (default 64)\nvalues.\n\nThis is for the extra paranoid configuration of `darknet_mode =\nDARKNET_AND_NOT_ALLOCATED`.  If you have `192.168.0.0/16` listed under\n`darknet_address_space`, but bro sees a bidirectional connection to\n`192.168.0.55` it will no longer treat all of `192.168.0.0/24` as dark.\n"}