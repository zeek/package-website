{"description": "Osquery script framework for communicating with osquery endpoints", "tags": "osquery", "version": "v0.4", "depends": ["zeek >=3.0.0-rc1"], "test_cmd": null, "build_cmd": null, "url": "https://github.com/zeek/osquery-framework", "summary": null, "script_dir": "osquery-framework", "plugin_dir": null, "readme": "\n# About\n\nThis Zeek script framework communicates with the [Zeek\nAgent](https://github.com/zeek/zeek-agent) to perform live\nqueries against the agent's tables and then incorporate the results\nback into Zeek's processing & logging. In addition to tables built in,\nthe agent can connect to [Osquery](https://osquery.io) to retrieve any\nof the host data provided there.\n\n*Note*: This framework is still a work in progress and expected to\nchange further in terms of API, functionality, and implementation.\n\n# Prerequisites\n\nThe framework requires Zeek 3.0+, which you can download and install\nper the instructions on the [Zeek web site](https://zeek.org/download).\n\nYou will also need to install the Zeek Agent itself, as well as\noptionally Osquery, according to [these\ninstructions](https://github.com/zeek/zeek-agent-framework).\n\n# Installation\n\nThe easiest way to install the `zeek-agent` framework is through the\n[Zeek package\nmanager](https://docs.zeek.org/projects/package-manager/en/stable/index.html).\nIf you have not installed the package manager yet, do that first:\n\n    # pip install zkg\n    # zkg autoconfig\n\n    # zkg install zeek/zeek-agent-framework\n\nAlternatively, you can clone the repository manually and copy it over\ninto Zeek's `site` folder:\n\n    # git clone https://github.com/zeek/zeek-agent-framework\n    # cp -a zeek-agent-framework/zeek-agent $(zeek-config --site_dir)\n\nIf you'd rather run it directly out of the local repository clone\n(rather than `site`), set your `ZEEKPATH` accordingly:\n\n    # export ZEEKPATH=<path/to/zeek-agent-framework>:$(zeek-config --zeekpath)\n\n# Usage\n\nUsing any of the three installation methods above, you can now load\nthe framework when you start Zeek:\n\n    # zeek zeek-agent\n\nOnce you start up any agents, you should start seeing a new Zeek log\nfile `zeek-agent.log` that records the hosts connecting to Zeek:\n\n    # cat zeek-agent.log\n    #fields    ts       source  peer        level   message\n    1576768875.018249\tlocal\tZeekMaster\tinfo\tSubscribing to zeek announce topic /zeek/zeek-agent/zeek_announce\n    1576768875.018249\tlocal\tZeekMaster\tinfo\tSubscribing to zeek individual topic /zeek/zeek-agent/zeek/C6EAF3CFDF46831E2D9103E5A1C48F78AD873A00#10223\n    1576768877.709030\tlocal\tZeekMaster\tinfo\tIncoming connection established from C6EAF3CFDF46831E2D9103E5A1C48F78AD873A3C#7503\n\nYou won't see much more at first as there's nothing sending queries to\nthe endhost yet. Check out the `examples/` directory for scripts that\nare using the built in (currently Linux audit based) and Osquery based\nfunctionality.\n\n# Examples\n\nThe framework ships with examples that currently use Osquery derived tables\nand Linux auditd based tables.  Use the follow lines to load all of the\nassociated examples.\n\nTo load the Osquery examples:\n\n    @load zeek-agent/examples/osquery\n\nTo load the auditd examples:\n\n    @load zeek-agent/examples/auditd\n\nTo load the EndpointSecurity (MacOS) examples:\n\n    @load zeek-agent/examples/endpointsecurity\n\n\n# Credits\n\nThis Zeek framework is based on an earlier implementation by [Steffen\nHaas](https://github.com/iBigQ), with recent work contributed by\n[Corelight](https://www.corelight.com) and [Trail of\nBits](https://www.trailofbits.com).\n"}