{"description": "A Zeek OpenVPN protocol analyzer, based on Spicy.", "tags": null, "version": "v0.1.6", "depends": null, "test_cmd": "cd tests && PATH=$(zkg config plugin_dir)/packages/spicy-plugin/bin:$PATH btest -d -j $(nproc)", "build_cmd": "mkdir -p build && cd build && SPICYZ=$(command -v spicyz || echo %(package_base)s/spicy-plugin/build/bin/spicyz) cmake .. && cmake --build .", "url": "https://github.com/corelight/zeek-spicy-openvpn", "summary": "A Zeek OpenVPN protocol analyzer, based on Spicy.", "script_dir": "analyzer", "plugin_dir": "build/spicy-modules", "readme": "# zeek-spicy-openvpn\n\nThis is a protocol analyzer that detects OpenVPN traffic.\nYou must install [Spicy](https://docs.zeek.org/projects/spicy/en/latest/)\nto use this package.\n\nBlogs and webinars detailing the development of this protocol analyzer:\n\n- <https://zeek.org/2021/03/16/a-zeek-openvpn-protocol-analyzer/>\n- <https://zeek.org/2021/04/08/a-zeek-openvpn-protocol-analyzer-in-spicy/>\n- <https://event.webinarjam.com/replay/16/405xvaqawfzfqn>\n  - Slides: <https://docs.google.com/presentation/d/1ftvMeQ-9hyeozTLXyO_CLVHDLGiwbJk9SqCp8laD1FM/edit?usp=sharing>\n\n## Example Log\n\n```\n$ cat conn.log\n#separator \\x09\n#set_separator\t,\n#empty_field\t(empty)\n#unset_field\t-\n#path\tconn\n#open\t2022-01-21-11-46-35\n#fields\tts\tuid\tid.orig_h\tid.orig_p\tid.resp_h\tid.resp_p\tproto\tservice\tduration\torig_bytes\tresp_bytes\tconn_state\tlocal_orig\tlocal_resp\tmissed_bytes\thistory\torig_pkts\torig_ip_bytes\tresp_pkts\tresp_ip_bytes\ttunnel_parents\n#types\ttime\tstring\taddr\tport\taddr\tport\tenum\tstring\tinterval\tcount\tcount\tstring\tbool\tbool\tcount\tstring\tcount\tcount\tcount\tcount\tset[string]\n1613755368.960989\tCyO1lb37w2czkxBsPd\t192.168.88.3\t50568\t46.246.122.61\t1198\tudp\tssl,spicy_openvpn_udp\t44.271572\t5825\t8524\tSF\t-\t-\t0\tDd\t57\t7421\t48\t9868\t-\n#close\t2022-01-21-11-46-35\n\n$ cat ssl.log\n#separator \\x09\n#set_separator\t,\n#empty_field\t(empty)\n#unset_field\t-\n#path\tssl\n#open\t2022-01-21-11-46-35\n#fields\tts\tuid\tid.orig_h\tid.orig_p\tid.resp_h\tid.resp_p\tversion\tcipher\tcurve\tserver_name\tresumed\tlast_alert\tnext_protocol\testablished\tssl_history\tcert_chain_fps\tclient_cert_chain_fps\tsni_matches_cert\tja3\tja3s\n#types\ttime\tstring\taddr\tport\taddr\tport\tstring\tstring\tstring\tstring\tbool\tstring\tstring\tbool\tstring\tvector[string]\tvector[string]\tbool\tstring\tstring\n1613755369.067702\tCyO1lb37w2czkxBsPd\t192.168.88.3\t50568\t46.246.122.61\t1198\tTLSv13\tTLS_AES_256_GCM_SHA384\tx25519\t-\tF\t-\t-\tT\tCsiI\t-\t-\t-\tc81fc162549590f0e836b538fe5bfdd7\t15af977ce25de452b96affa2addb1036\n#close\t2022-01-21-11-46-35\n```\n\n## Sample PCAPs\n\n- [openvpn-tcp-tls-auth.pcap](https://wiki.wireshark.org/SampleCaptures?action=AttachFile&do=get&target=OpenVPN_TCP_tls-auth.pcapng)\n- openvpn.pcap (self-made)\n- openvpn_udp_hmac_256.pcap (self-made)\n- [openvpn_tcp_nontlsauth.pcap](https://bugs.wireshark.org/bugzilla/attachment.cgi?id=9840)\n- [openvpn_udp_tls-auth.pcap](https://wiki.wireshark.org/SampleCaptures?action=AttachFile&do=get&target=OpenVPN_UDP_tls-auth.pcapng)\n"}