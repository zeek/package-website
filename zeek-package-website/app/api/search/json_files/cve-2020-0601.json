{"description": "\"Test script for CVE-2020-0601. Please read Readme.\"", "tags": null, "version": "v0.4", "depends": ["zkg >=2.0", "zeek >=4.0.0"], "test_cmd": "cd testing && btest -d", "build_cmd": null, "url": "https://github.com/0xxon/cve-2020-0601", "summary": null, "script_dir": "scripts", "plugin_dir": null, "readme": "Zeek test script for CVE-2020-0601\n==================================\n\nThis script can detect exploit attempts for CVE-2020-0601. It performs a\nsimple check to see if a known curve is used in a certificate - if this is not the\ncase a notice is raised.\n\nExample notice in notice.log:\n\n```\n1579043477.791522\tCHhAvVGS1DHFjwGM9\t192.241.209.49\t46110\t192.241.202.21\t4433\tF37z6n1B8zn1fZjpj\tapplication/x-x509-user-cert\t192.241.202.21:4433/tcp\ttcp\tCVE_2020_0601::Unknown_X509_Curve\tECC certificate with unknown curve; potential CVE-2020-0601 exploit attempt\t-\t192.241.209.49\t192.241.202.21\t4433\t-\t-\tNotice::ACTION_LOG\t3600.000000\t-\t-\t-\t-\t-\n```\n\nTo log suspicious certificates please use\n\n```\nredef CVE_2020_0601::log_certs = T;\n```\n\nin your local.zeek to turn on extraction. Once this is turned on, suspicious\ncertificates will be logged to a new cve-2020-0601-certs.log file.\n\nImportant note:\n--------------\n\nThis script requires an OpenSSL installation that automatically converts\nexplicit curves to names while the certificate is parsed. Many versions of OpenSSL\nshipped by different Linux distributions do not seem to do that; I am currently a bit\nunsure of why this is the case.\n\nUsing OpenSSL versions with differing behavior will lead to a higher amount of\nfalse positives. The tests for this package will check OpenSSL behavior during\ninstallation; if the \"explicit.zeek\" tests fails your version of OpenSSL does not\nbehave as required.\n\nIn this case, the script will alert on all certificates that have explicit curve\ndefinitions too; these should be very very rare, but are not per se a problem.\n\nThere is a second version of this plugin available at https://github.com/0xxon/cve-2020-0601-plugin.\nThe second version uses OpenSSL primitives to directly check a certificate curve.\nHowever, the plugin version requires OpenSSL 1.1.x - and requires C++ code to be built\nand loaded in your Zeek installation.\n\nThe advantages of the plugin version at https://github.com/0xxon/cve-2020-0601-plugin are\na higher accuracy - with more specific notices that give more information about an exploit\nattempt that was found. The disadvantages mostly are higher installation friction.\n\nDisclaimer:\n-----------\n\nWhile this plugin successfully detects known POC code, it is possible (but unlikely)\nthat another variant of the attack might not be detected.\n"}