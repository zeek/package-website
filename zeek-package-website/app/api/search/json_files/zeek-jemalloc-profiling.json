{"description": "A broctl plugin that enables jemalloc profiling", "tags": "broctl, jemalloc, profiling", "version": "master", "depends": null, "test_cmd": null, "build_cmd": null, "url": "https://github.com/JustinAzoff/zeek-jemalloc-profiling", "summary": null, "script_dir": null, "plugin_dir": "plugin", "readme": "# Installing\n\n    zkg install zeek-jemalloc-profiling\n\n# Verify jemalloc support:\n\n    root@x230:~# zeekctl jeprof.check\n    jemalloc profiling enabled: True\n\n# Enabling\n\nIn your node.cfg add jeprof_enable=1 like so:\n\n    [worker-1]\n    type=worker\n    host=localhost\n    interface=af_packet::eth0\n    lb_method=custom\n    lb_procs=2\n    jeprof_enable=1\n\n# All options\n\nNode options:\n\n    jeprof_enable=1  # Enable jeprof\n    jeprof_all_workers=true #Enable profiling on all workers instead of just the first one\n\nGlobal options for broctl.cfg:\n\n    jeprof.malloc_conf=...  # extra options to add to MALLOC_CONF\n    jeprof.lg_prof_interval=30 # see http://jemalloc.net/jemalloc.3.html#opt.lg_prof_interval\n\n# Processing profile output\n\n    ./process.py /usr/local/zeek/spool | tee -a jeprof.log\n\n# Graphing\n\nThe ``process.py`` script can be useful to stream the profile to an external metrics\nsystem for long term recording.\n\nFor interactive debugging it can be more useful to use the ``jeprof`` utility\ndirectly with the ``.heap`` files stored in a worker's spool directory.\n\nEither by using the text interface directly, or export data to an SVG file (or the dot raw data with ``--dot``):\n\n    $ jeprof /opt/zeek/bin/zeek --svg $(ls /opt/zeek/spool/worker-1-1/jeprof.out*heap | tail -n 1) > profile-$(date +%Y%m%d-%H%M%S).svg\n\nAbove command will produce an SVG for the most recent .heap file created.\n"}