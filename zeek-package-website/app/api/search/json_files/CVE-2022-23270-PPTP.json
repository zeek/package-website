{"description": "A package to detect CVE-2022-23270.", "tags": null, "version": "master", "depends": ["zeek >=4.0.0"], "test_cmd": "cd testing && btest -c btest.cfg", "build_cmd": null, "url": "https://github.com/corelight/CVE-2022-23270-PPTP", "summary": "A package to detect CVE-2022-23270.", "script_dir": "scripts", "plugin_dir": null, "readme": "# CVE-2022-23270\n\nA package to detect CVE-2022-23270, a vulnerability in Microsoft's PPTP implementation.\n\n## Example\n\nYou can run this logic on the included PCAP in the `testing\\traces` directory:\n\n```\n$ zeek -Cr CVE-2022-23270-exploited.pcap packages\n\n$ cat notice.log \n#separator \\x09\n#set_separator\t,\n#empty_field\t(empty)\n#unset_field\t-\n#path\tnotice\n#open\t2022-05-10-23-03-47\n#fields\tts\tuid\tid.orig_h\tid.orig_p\tid.resp_h\tid.resp_p\tfuid\tfile_mime_type\tfile_desc\tproto\tnote\tmsg\tsub\tsrc\tdst\tp\tn\tpeer_descr\tactions\temail_dest\tsuppress_for\tremote_location.country_code\tremote_location.region\tremote_location.city\tremote_location.latitude\tremote_location.longitude\n#types\ttime\tstring\taddr\tport\taddr\tport\tstring\tstring\tstring\tenum\tenum\tstring\tstring\taddr\taddr\tport\tcount\tstring\tset[enum]\tset[string]\tinterval\tstring\tstring\tstring\tdouble\tdouble\n1652212222.744235\tCHhAvVGS1DHFjwGM9\t192.168.88.166\t51143\t192.168.88.157\t1723\t-\t-\t-\ttcp\tCVE202223270::CVE_2022_23270_Attempt\tPotential PPTP CVE-2022-23270 exploit attempt: 192.168.88.166 attempted exploit against 192.168.88.157\t-\t192.168.88.166\t192.168.88.157\t1723\t-\t-\tNotice::ACTION_LOG\t(empty)\t3600.000000\t-\t-\t-\t-\t-\n1652212222.744235\tCHhAvVGS1DHFjwGM9\t192.168.88.166\t51143\t192.168.88.157\t1723\t-\t-\t-\ttcp\tCVE202223270::CVE_2022_23270_Success\tPPTP CVE-2022-23270 exploit success: 192.168.88.166 exploited 192.168.88.157\t-\t192.168.88.166\t192.168.88.157\t1723\t-\t-\tNotice::ACTION_LOG\t(empty)\t3600.000000\t-\t-\t-\t-\t-\n#close\t2022-05-10-23-03-47\n```\n\n## RFCs\n- https://datatracker.ietf.org/doc/html/rfc2637"}