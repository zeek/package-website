{"description": "Add VLAN to all logs.", "tags": "log extend vlan", "version": "v1.0.3", "depends": null, "test_cmd": null, "build_cmd": null, "url": "https://github.com/corelight/log-add-vlan-everywhere", "summary": null, "script_dir": "scripts", "plugin_dir": null, "readme": "Add VLAN tags to all Zeek logs\n------------------------------\n\nThis script adds VLAN tags to all of the Zeek logs that have the ``conn_id``\n(``id``) field.\n\nInstallation\n------------\n\n::\n\n  zkg refresh\n  zkg install corelight/log-add-vlan-everywhere\n\nUsage\n-----\n\nAll Zeek logs that contain connection information with the ``c$id`` field \nshould have fields that indicate VLAN tags (named ``vlan`` and ``inner_vlan``).\n\nPotential Side Effects\n----------------------\n\nThere are potential side effects from loading this script if another script\nis indexing tables based on the ``c$id`` field.  This generally is not done\nin most modern scripts and is not done in the core Zeek distribution anywhere.\n\nThis script tries to avoid potential trouble with this indexing issue by \nonly grabbing the VLAN information from the  ``connection_established`` \nevent because any other script that uses ``c$id`` for indexing would probably\nalways get the value that was collected already anyway.\n\nIf you think that this script is impacting any other script please reach out \nto us at support@corelight.com and let us know what script you think it might\nbe impacting.\n\nAuthors\n-------\n\n:: \n\n  Nate Guagenti @neu5ron\n  Seth Hall <seth@corelight.com>\n"}