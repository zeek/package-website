{"description": "A network detection package for CVE-2020-5902, a CVE10.0 vulnerability affecting F5 Networks, Inc BIG-IP devices.", "tags": "BIGIP, F5, firewall, RCE, CVE10.0, CVE10, CorelightResponse", "version": "master", "depends": null, "test_cmd": null, "build_cmd": null, "url": "https://github.com/corelight/CVE-2020-5902-F5BigIP", "summary": null, "script_dir": "scripts", "plugin_dir": null, "readme": "# CVE-2020-5902 (F5 BIG-IP devices)\n\n\n## Summary:  \nA Zeek detection package for CVE-2020-5902, a CVE10.0 vulnerability affecting F5 Networks BIG-IP devices.\n\n## References: \n- https://corelight.blog/2020/07/28/zeek-in-its-sweet-spot-detecting-f5s-big-ip-cve10-cve-2020-5902/\n- https://support.f5.com/csp/article/K52145254\n- https://us-cert.cisa.gov/ncas/alerts/aa20-206a\n\n## Notices raised :   \n\nBy default both notices are enabled, however if you'd like to enable only the notice concerning a successful exploit you can change the option in `scripts/bigIPF5.zeek` to True i.e `option only_monitor_for_successful_exploit: bool = T;`\n\n|Notice|Enabled by default?|Disable with only_monitor_for_successful_exploit = T|\n|---|------|---------|\n| BIGIP_exploit_attempt|Yes|Yes|\n| BIGIP_exploit_success|Yes|No|\n\n\nNotices include up to 1500 bytes of the HTTP request headers as well as uri information, which can be helpful to speed up Incident Response and triage, without necessarily needing to refer back to a pcap. Example:\n\n`#separator \\x09\n#set_separator\t,\n#empty_field\t(empty)\n#unset_field\t-\n#path\tnotice\n#open\t2020-07-27-16-57-12\n#fields\tts\tuid\tid.orig_h\tid.orig_p\tid.resp_h\tid.resp_p\tfuid\tfile_mime_type\tfile_desc\tproto\tnote\tmsg\tsub\tsrc\tdst\tp\tn\tpeer_descr\tactions\tsuppress_for\tremote_location.country_code\tremote_location.region\tremote_location.city\tremote_location.latitude\tremote_location.longitude\n#types\ttime\tstring\taddr\tport\taddr\tport\tstring\tstring\tstring\tenum\tenum\tstring\tstring\taddr\taddr\tport\tcount\tstring\tset[enum]\tinterval\tstring\tstringstring\tdouble\tdouble`\n\n`1595831352.218935\tC9EcoD1bu0ertt08bb\t192.168.31.37\t63034\t192.168.1.3\t80\t-\t-\t-\ttcp\tCVE_2020_5902::BIGIP_exploit_attempt\tAn attempt to exploit an F5 BIG-IP device via CVE-2020-5902 was detected using uri '/hsqldb;' , however the server responded with a code='404' reason='Not Found', indicating the exploit attempt failed. The HTTP request headers are '{\\x0a\\x09[1] = [original_name=User-Agent, name=USER-AGENT, value=Wget/1.20.3 (darwin19.0.0)],\\x0a\\x09[2] = [original_name=Accept, name=ACCEPT, value=*/*],\\x0a\\x09[3] = [original_name=Accept-Encoding, name=ACCEPT-ENCODING, value=identity],\\x0a\\x09[4] = [original_name=Host, name=HOST, value=192.168.1.3],\\x0a\\x09[5] = [original_name=Connection, name=CONNECTION, value=Keep-Alive]\\x0a}'. Refer to https://support.f5.com/csp/article/K52145254\t-\t192.168.31.37\t192.168.1.3\t80\t-\t-\tNotice::ACTION_LOG\t3600.000000\t-\t-\t-\t-\t-\n`\n\n\n## Usage, notes and recommendations:\n- To use against a pcap you already have ```zeek -Cr your.pcap scripts/__load__.zeek```   \n- This package will run in live clustered or non clustered environments.  \n- This package has been prepared based on a selection of current publicly available information, not against pcaps of exploits.\n\n## Feedback\n- As details emerge, we are keen to improve this package for the benefit of the community, please feel free to contact the author with any suggestions and feedback.\n"}